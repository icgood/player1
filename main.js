!function(t){var i={};function e(n){if(i[n])return i[n].exports;var s=i[n]={i:n,l:!1,exports:{}};return t[n].call(s.exports,s,s.exports,e),s.l=!0,s.exports}e.m=t,e.c=i,e.d=function(t,i,n){e.o(t,i)||Object.defineProperty(t,i,{enumerable:!0,get:n})},e.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e.t=function(t,i){if(1&i&&(t=e(t)),8&i)return t;if(4&i&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(e.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&i&&"string"!=typeof t)for(var s in t)e.d(n,s,function(i){return t[i]}.bind(null,s));return n},e.n=function(t){var i=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(i,"a",i),i},e.o=function(t,i){return Object.prototype.hasOwnProperty.call(t,i)},e.p="",e(e.s=29)}([function(t,i,e){"undefined"==typeof DEBUG&&(DEBUG=!0);var n=e(5),s=e(6),o=e(7),r=e(12);function h(t){if(!(this instanceof h))return o.fn(t)?h.app.apply(h,arguments):o.object(t)?h.atlas.apply(h,arguments):t;n.create++;for(var i=0;i<a.length;i++)a[i].call(this)}n.create=0;var a=[];h._init=function(t){a.push(t)};var u=[];h._load=function(t){u.push(t)};var c={};h.config=function(){if(1===arguments.length&&o.string(arguments[0]))return c[arguments[0]];1===arguments.length&&o.object(arguments[0])&&s(c,arguments[0]),2===arguments.length&&o.string(arguments[0])&&(arguments[0],arguments[1])};var f=[],l=[],p=!1,_=!1;h.app=function(t,i){if(p){DEBUG&&console.log("Creating app...");var e=h.config("app-loader");e((function(i,e){DEBUG&&console.log("Initing app...");for(var n=0;n<u.length;n++)u[n].call(this,i,e);t(i,e),l.push(i),DEBUG&&console.log("Starting app..."),i.start()}),i)}else f.push(arguments)};var d=r();h.preload=function(t){if("string"==typeof t){var i=h.resolve(t);/\.js($|\?|\#)/.test(i)&&(DEBUG&&console.log("Loading script: "+i),t=function(t){!function(t,i){var e=document.createElement("script");e.addEventListener("load",(function(){i()})),e.addEventListener("error",(function(e){i(e||"Error loading script: "+t)})),e.src=t,e.id="preload-"+Date.now(),document.body.appendChild(e)}(i,t)})}"function"==typeof t&&t(d())},h.start=function(t){DEBUG&&console.log("Starting..."),h.config(t),d.then((function(){for(DEBUG&&console.log("Loading apps..."),p=!0;f.length;){var t=f.shift();h.app.apply(h,t)}}))},h.pause=function(){if(!_){_=!0;for(var t=l.length-1;t>=0;t--)l[t].pause()}},h.resume=function(){if(_){_=!1;for(var t=l.length-1;t>=0;t--)l[t].resume()}},h.create=function(){return new h},h.resolve=function(){if("undefined"==typeof window||"undefined"==typeof document)return function(t){return t};var t=document.getElementsByTagName("script");return function(i){if(/^\.\//.test(i)){var e=function(){if(document.currentScript)return document.currentScript.src;var i;try{var e=new Error;if(!e.stack)throw e;i=e.stack}catch(e){i=e.stack}if("string"==typeof i)for(var n=(i=i.split("\n")).length;n--;){var s=i[n].match(/(\w+\:\/\/[^/]*?\/.+?)(:\d+)(:\d+)?/);if(s)return s[1]}if(t.length&&"readyState"in t[0])for(n=t.length;n--;)if("interactive"===t[n].readyState)return t[n].src;return location.href}();i=e.substring(0,e.lastIndexOf("/")+1)+i.substring(2)}return i}}(),t.exports=h},function(t,i,e){t.exports=e(11),t.exports.internal={},e(19),t.exports.internal.Image=e(20),e(22),e(23),e(24),e(25),t.exports.Mouse=e(27),t.exports.Math=e(9),t.exports._extend=e(6),t.exports._create=e(2),e(28)},function(t,i){if("function"==typeof Object.create)t.exports=function(t,i){return Object.create.call(Object,t,i)};else{function e(){}t.exports=function(t,i){if(i)throw Error("Second argument is not supported!");if("object"!=typeof t||null===t)throw Error("Invalid prototype!");return e.prototype=t,new e}}},function(t,i,e){var n=e(0),s=e(10),o=0;function r(t){this._owner=t,this._parent=null,this._relativeMatrix=new s,this._absoluteMatrix=new s,this.reset()}n._init((function(){this._pin=new r(this)})),n.prototype.matrix=function(t){return!0===t?this._pin.relativeMatrix():this._pin.absoluteMatrix()},n.prototype.pin=function(t,i){return"object"==typeof t?(this._pin.set(t),this):"string"==typeof t?void 0===i?this._pin.get(t):(this._pin.set(t,i),this):void 0===t?this._pin:void 0},r.prototype.reset=function(){this._textureAlpha=1,this._alpha=1,this._width=0,this._height=0,this._scaleX=1,this._scaleY=1,this._skewX=0,this._skewY=0,this._rotation=0,this._pivoted=!1,this._pivotX=null,this._pivotY=null,this._handled=!1,this._handleX=0,this._handleY=0,this._aligned=!1,this._alignX=0,this._alignY=0,this._offsetX=0,this._offsetY=0,this._boxX=0,this._boxY=0,this._boxWidth=this._width,this._boxHeight=this._height,this._ts_translate=++o,this._ts_transform=++o,this._ts_matrix=++o},r.prototype._update=function(){return this._parent=this._owner._parent&&this._owner._parent._pin,this._handled&&this._mo_handle!=this._ts_transform&&(this._mo_handle=this._ts_transform,this._ts_translate=++o),this._aligned&&this._parent&&this._mo_align!=this._parent._ts_transform&&(this._mo_align=this._parent._ts_transform,this._ts_translate=++o),this},r.prototype.toString=function(){return this._owner+" ("+(this._parent?this._parent._owner:null)+")"},r.prototype.absoluteMatrix=function(){this._update();var t=Math.max(this._ts_transform,this._ts_translate,this._parent?this._parent._ts_matrix:0);if(this._mo_abs==t)return this._absoluteMatrix;this._mo_abs=t;var i=this._absoluteMatrix;return i.reset(this.relativeMatrix()),this._parent&&i.concat(this._parent._absoluteMatrix),this._ts_matrix=++o,i},r.prototype.relativeMatrix=function(){this._update();var t=Math.max(this._ts_transform,this._ts_translate,this._parent?this._parent._ts_transform:0);if(this._mo_rel==t)return this._relativeMatrix;this._mo_rel=t;var i,e,n=this._relativeMatrix;(n.identity(),this._pivoted&&n.translate(-this._pivotX*this._width,-this._pivotY*this._height),n.scale(this._scaleX,this._scaleY),n.skew(this._skewX,this._skewY),n.rotate(this._rotation),this._pivoted&&n.translate(this._pivotX*this._width,this._pivotY*this._height),this._pivoted)?(this._boxX=0,this._boxY=0,this._boxWidth=this._width,this._boxHeight=this._height):(n.a>0&&n.c>0||n.a<0&&n.c<0?(i=0,e=n.a*this._width+n.c*this._height):(i=n.a*this._width,e=n.c*this._height),i>e?(this._boxX=e,this._boxWidth=i-e):(this._boxX=i,this._boxWidth=e-i),n.b>0&&n.d>0||n.b<0&&n.d<0?(i=0,e=n.b*this._width+n.d*this._height):(i=n.b*this._width,e=n.d*this._height),i>e?(this._boxY=e,this._boxHeight=i-e):(this._boxY=i,this._boxHeight=e-i));return this._x=this._offsetX,this._y=this._offsetY,this._x-=this._boxX+this._handleX*this._boxWidth,this._y-=this._boxY+this._handleY*this._boxHeight,this._aligned&&this._parent&&(this._parent.relativeMatrix(),this._x+=this._alignX*this._parent._width,this._y+=this._alignY*this._parent._height),n.translate(this._x,this._y),this._relativeMatrix},r.prototype.get=function(t){if("function"==typeof h[t])return h[t](this)},r.prototype.set=function(t,i){if("string"==typeof t)"function"==typeof a[t]&&void 0!==i&&a[t](this,i);else if("object"==typeof t)for(i in t)"function"==typeof a[i]&&void 0!==t[i]&&a[i](this,t[i],t);return this._owner&&(this._owner._ts_pin=++o,this._owner.touch()),this};var h={alpha:function(t){return t._alpha},textureAlpha:function(t){return t._textureAlpha},width:function(t){return t._width},height:function(t){return t._height},boxWidth:function(t){return t._boxWidth},boxHeight:function(t){return t._boxHeight},scaleX:function(t){return t._scaleX},scaleY:function(t){return t._scaleY},skewX:function(t){return t._skewX},skewY:function(t){return t._skewY},rotation:function(t){return t._rotation},pivotX:function(t){return t._pivotX},pivotY:function(t){return t._pivotY},offsetX:function(t){return t._offsetX},offsetY:function(t){return t._offsetY},alignX:function(t){return t._alignX},alignY:function(t){return t._alignY},handleX:function(t){return t._handleX},handleY:function(t){return t._handleY}},a={alpha:function(t,i){t._alpha=i},textureAlpha:function(t,i){t._textureAlpha=i},width:function(t,i){t._width_=i,t._width=i,t._ts_transform=++o},height:function(t,i){t._height_=i,t._height=i,t._ts_transform=++o},scale:function(t,i){t._scaleX=i,t._scaleY=i,t._ts_transform=++o},scaleX:function(t,i){t._scaleX=i,t._ts_transform=++o},scaleY:function(t,i){t._scaleY=i,t._ts_transform=++o},skew:function(t,i){t._skewX=i,t._skewY=i,t._ts_transform=++o},skewX:function(t,i){t._skewX=i,t._ts_transform=++o},skewY:function(t,i){t._skewY=i,t._ts_transform=++o},rotation:function(t,i){t._rotation=i,t._ts_transform=++o},pivot:function(t,i){t._pivotX=i,t._pivotY=i,t._pivoted=!0,t._ts_transform=++o},pivotX:function(t,i){t._pivotX=i,t._pivoted=!0,t._ts_transform=++o},pivotY:function(t,i){t._pivotY=i,t._pivoted=!0,t._ts_transform=++o},offset:function(t,i){t._offsetX=i,t._offsetY=i,t._ts_translate=++o},offsetX:function(t,i){t._offsetX=i,t._ts_translate=++o},offsetY:function(t,i){t._offsetY=i,t._ts_translate=++o},align:function(t,i){this.alignX(t,i),this.alignY(t,i)},alignX:function(t,i){t._alignX=i,t._aligned=!0,t._ts_translate=++o,this.handleX(t,i)},alignY:function(t,i){t._alignY=i,t._aligned=!0,t._ts_translate=++o,this.handleY(t,i)},handle:function(t,i){this.handleX(t,i),this.handleY(t,i)},handleX:function(t,i){t._handleX=i,t._handled=!0,t._ts_translate=++o},handleY:function(t,i){t._handleY=i,t._handled=!0,t._ts_translate=++o},resizeMode:function(t,i,e){e&&("in"==i?i="in-pad":"out"==i&&(i="out-crop"),u(t,e.resizeWidth,e.resizeHeight,i))},resizeWidth:function(t,i,e){e&&e.resizeMode||u(t,i,null)},resizeHeight:function(t,i,e){e&&e.resizeMode||u(t,null,i)},scaleMode:function(t,i,e){e&&u(t,e.scaleWidth,e.scaleHeight,i)},scaleWidth:function(t,i,e){e&&e.scaleMode||u(t,i,null)},scaleHeight:function(t,i,e){e&&e.scaleMode||u(t,null,i)},matrix:function(t,i){this.scaleX(t,i.a),this.skewX(t,i.c/i.d),this.skewY(t,i.b/i.a),this.scaleY(t,i.d),this.offsetX(t,i.e),this.offsetY(t,i.f),this.rotation(t,0)}};function u(t,i,e,n){var s="number"==typeof i,r="number"==typeof e,h="string"==typeof n;t._ts_transform=++o,s&&(t._scaleX=i/t._width_,t._width=t._width_),r&&(t._scaleY=e/t._height_,t._height=t._height_),s&&r&&h&&("out"==n||"out-crop"==n?t._scaleX=t._scaleY=Math.max(t._scaleX,t._scaleY):"in"!=n&&"in-pad"!=n||(t._scaleX=t._scaleY=Math.min(t._scaleX,t._scaleY)),"out-crop"!=n&&"in-pad"!=n||(t._width=i/t._scaleX,t._height=e/t._scaleY))}n.prototype.scaleTo=function(t,i,e){return"object"==typeof t&&(e=i,i=t.y,t=t.x),u(this._pin,t,i,e),this},r._add_shortcuts=function(t){t.prototype.size=function(t,i){return this.pin("width",t),this.pin("height",i),this},t.prototype.width=function(t){return void 0===t?this.pin("width"):(this.pin("width",t),this)},t.prototype.height=function(t){return void 0===t?this.pin("height"):(this.pin("height",t),this)},t.prototype.offset=function(t,i){return"object"==typeof t&&(i=t.y,t=t.x),this.pin("offsetX",t),this.pin("offsetY",i),this},t.prototype.rotate=function(t){return this.pin("rotation",t),this},t.prototype.skew=function(t,i){return"object"==typeof t?(i=t.y,t=t.x):void 0===i&&(i=t),this.pin("skewX",t),this.pin("skewY",i),this},t.prototype.scale=function(t,i){return"object"==typeof t?(i=t.y,t=t.x):void 0===i&&(i=t),this.pin("scaleX",t),this.pin("scaleY",i),this},t.prototype.alpha=function(t,i){return this.pin("alpha",t),void 0!==i&&this.pin("textureAlpha",i),this}},r._add_shortcuts(n),t.exports=r},function(t,i,e){var n=e(0);e(3);var s=e(5);n.prototype._textures=null,n.prototype._alpha=1,n.prototype.render=function(t){if(this._visible){s.node++;var i=this.matrix();t.setTransform(i.a,i.b,i.c,i.d,i.e,i.f),this._alpha=this._pin._alpha*(this._parent?this._parent._alpha:1);var e=this._pin._textureAlpha*this._alpha;if(t.globalAlpha!=e&&(t.globalAlpha=e),null!==this._textures)for(var n=0,o=this._textures.length;n<o;n++)this._textures[n].draw(t);t.globalAlpha!=this._alpha&&(t.globalAlpha=this._alpha);for(var r,h=this._first;r=h;)h=r._next,r.render(t)}},n.prototype._tickBefore=null,n.prototype._tickAfter=null,n.prototype.MAX_ELAPSE=1/0,n.prototype._tick=function(t,i,e){if(this._visible){t>this.MAX_ELAPSE&&(t=this.MAX_ELAPSE);var n=!1;if(null!==this._tickBefore)for(var o=0;o<this._tickBefore.length;o++){s.tick++,n=!0===this._tickBefore[o].call(this,t,i,e)||n}for(var r,h=this._first;r=h;)h=r._next,r._flag("_tick")&&(n=!0===r._tick(t,i,e)||n);if(null!==this._tickAfter)for(o=0;o<this._tickAfter.length;o++){s.tick++,n=!0===this._tickAfter[o].call(this,t,i,e)||n}return n}},n.prototype.tick=function(t,i){"function"==typeof t&&(i?(null===this._tickBefore&&(this._tickBefore=[]),this._tickBefore.push(t)):(null===this._tickAfter&&(this._tickAfter=[]),this._tickAfter.push(t)),this._flag("_tick",null!==this._tickAfter&&this._tickAfter.length>0||null!==this._tickBefore&&this._tickBefore.length>0))},n.prototype.untick=function(t){var i;"function"==typeof t&&(null!==this._tickBefore&&(i=this._tickBefore.indexOf(t))>=0&&this._tickBefore.splice(i,1),null!==this._tickAfter&&(i=this._tickAfter.indexOf(t))>=0&&this._tickAfter.splice(i,1))},n.prototype.timeout=function(t,i){this.setTimeout(t,i)},n.prototype.setTimeout=function(t,i){function e(n){if(!((i-=n)<0))return!0;this.untick(e),t.call(this)}return this.tick(e),e},n.prototype.clearTimeout=function(t){this.untick(t)}},function(t,i){t.exports={}},function(t,i){t.exports=function(t){for(var i=1;i<arguments.length;i++){var e=arguments[i];for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])}return t}},function(t,i){
/**
 * ! is the definitive JavaScript type testing library
 * 
 * @copyright 2013-2014 Enrico Marino / Jordan Harband
 * @license MIT
 */
var e=Object.prototype,n=e.hasOwnProperty,s=e.toString,o=/^[A-Fa-f0-9]+$/,r=t.exports={};r.a=r.an=r.type=function(t,i){return typeof t===i},r.defined=function(t){return void 0!==t},r.empty=function(t){var i,e=s.call(t);if("[object Array]"===e||"[object Arguments]"===e||"[object String]"===e)return 0===t.length;if("[object Object]"===e){for(i in t)if(n.call(t,i))return!1;return!0}return!t},r.equal=function(t,i){if(t===i)return!0;var e,n=s.call(t);if(n!==s.call(i))return!1;if("[object Object]"===n){for(e in t)if(!(r.equal(t[e],i[e])&&e in i))return!1;for(e in i)if(!(r.equal(t[e],i[e])&&e in t))return!1;return!0}if("[object Array]"===n){if((e=t.length)!==i.length)return!1;for(;--e;)if(!r.equal(t[e],i[e]))return!1;return!0}return"[object Function]"===n?t.prototype===i.prototype:"[object Date]"===n&&t.getTime()===i.getTime()},r.instance=function(t,i){return t instanceof i},r.nil=function(t){return null===t},r.undef=function(t){return void 0===t},r.array=function(t){return"[object Array]"===s.call(t)},r.emptyarray=function(t){return r.array(t)&&0===t.length},r.arraylike=function(t){return!!t&&!r.boolean(t)&&n.call(t,"length")&&isFinite(t.length)&&r.number(t.length)&&t.length>=0},r.boolean=function(t){return"[object Boolean]"===s.call(t)},r.element=function(t){return void 0!==t&&"undefined"!=typeof HTMLElement&&t instanceof HTMLElement&&1===t.nodeType},r.fn=function(t){return"[object Function]"===s.call(t)},r.number=function(t){return"[object Number]"===s.call(t)},r.nan=function(t){return!r.number(t)||t!=t},r.object=function(t){return"[object Object]"===s.call(t)},r.hash=function(t){return r.object(t)&&t.constructor===Object&&!t.nodeType&&!t.setInterval},r.regexp=function(t){return"[object RegExp]"===s.call(t)},r.string=function(t){return"[object String]"===s.call(t)},r.hex=function(t){return r.string(t)&&(!t.length||o.test(t))}},function(t,i,e){var n=e(5),s=e(9);function o(t,i){"object"==typeof t&&this.src(t,i)}o.prototype.pipe=function(){return new o(this)},o.prototype.src=function(t,i,e,n){if("object"==typeof t){var s=t,o=i||1;this._image=s,this._sx=this._dx=0,this._sy=this._dy=0,this._sw=this._dw=s.width/o,this._sh=this._dh=s.height/o,this.width=s.width/o,this.height=s.height/o,this.ratio=o}else void 0===e?(e=t,n=i):(this._sx=t,this._sy=i),this._sw=this._dw=e,this._sh=this._dh=n,this.width=e,this.height=n;return this},o.prototype.dest=function(t,i,e,n){return this._dx=t,this._dy=i,this._dx=t,this._dy=i,void 0!==e&&(this._dw=e,this._dh=n,this.width=e,this.height=n),this},o.prototype.draw=function(t,i,e,o,r,h,a,u,c){var f=this._image;if(null!==f&&"object"==typeof f){var l=this._sx,p=this._sy,_=this._sw,d=this._sh,g=this._dx,v=this._dy,y=this._dw,m=this._dh;void 0!==h?(i=s.limit(i,0,this._sw),o=s.limit(o,0,this._sw-i),l+=i,p+=e=s.limit(e,0,this._sh),_=o,d=r=s.limit(r,0,this._sh-e),g=h,v=a,y=u,m=c):void 0!==o?(g=i,v=e,y=o,m=r):void 0!==i&&(y=i,m=e);var x=this.ratio||1;l*=x,p*=x,_*=x,d*=x;try{"function"==typeof f.draw?f.draw(t,l,p,_,d,g,v,y,m):(n.draw++,t.drawImage(f,l,p,_,d,g,v,y,m))}catch(t){f._draw_failed||(console.log("Unable to draw: ",f),console.log(t),f._draw_failed=!0)}}},t.exports=o},function(t,i,e){var n=e(2),s=Math;t.exports=n(Math),t.exports.random=function(t,i){return void 0===t?(i=1,t=0):void 0===i&&(i=t,t=0),t==i?t:s.random()*(i-t)+t},t.exports.rotate=function(t,i,e){return void 0===i?(e=1,i=0):void 0===e&&(e=i,i=0),e>i?(t=(t-i)%(e-i))+(t<0?e:i):(t=(t-e)%(i-e))+(t<=0?i:e)},t.exports.limit=function(t,i,e){return t<i?i:t>e?e:t},t.exports.length=function(t,i){return s.sqrt(t*t+i*i)}},function(t,i){function e(t,i,e,n,s,o){this.reset(t,i,e,n,s,o)}e.prototype.toString=function(){return"["+this.a+", "+this.b+", "+this.c+", "+this.d+", "+this.e+", "+this.f+"]"},e.prototype.clone=function(){return new e(this.a,this.b,this.c,this.d,this.e,this.f)},e.prototype.reset=function(t,i,e,n,s,o){return this._dirty=!0,"object"==typeof t?(this.a=t.a,this.d=t.d,this.b=t.b,this.c=t.c,this.e=t.e,this.f=t.f):(this.a=t||1,this.d=n||1,this.b=i||0,this.c=e||0,this.e=s||0,this.f=o||0),this},e.prototype.identity=function(){return this._dirty=!0,this.a=1,this.b=0,this.c=0,this.d=1,this.e=0,this.f=0,this},e.prototype.rotate=function(t){if(!t)return this;this._dirty=!0;var i=t?Math.cos(t):1,e=t?Math.sin(t):0,n=i*this.a-e*this.b,s=i*this.b+e*this.a,o=i*this.c-e*this.d,r=i*this.d+e*this.c,h=i*this.e-e*this.f,a=i*this.f+e*this.e;return this.a=n,this.b=s,this.c=o,this.d=r,this.e=h,this.f=a,this},e.prototype.translate=function(t,i){return t||i?(this._dirty=!0,this.e+=t,this.f+=i,this):this},e.prototype.scale=function(t,i){return t-1||i-1?(this._dirty=!0,this.a*=t,this.b*=i,this.c*=t,this.d*=i,this.e*=t,this.f*=i,this):this},e.prototype.skew=function(t,i){if(!t&&!i)return this;this._dirty=!0;var e=this.a+this.b*t,n=this.b+this.a*i,s=this.c+this.d*t,o=this.d+this.c*i,r=this.e+this.f*t,h=this.f+this.e*i;return this.a=e,this.b=n,this.c=s,this.d=o,this.e=r,this.f=h,this},e.prototype.concat=function(t){this._dirty=!0;var i=this,e=i.a*t.a+i.b*t.c,n=i.b*t.d+i.a*t.b,s=i.c*t.a+i.d*t.c,o=i.d*t.d+i.c*t.b,r=i.e*t.a+t.e+i.f*t.c,h=i.f*t.d+t.f+i.e*t.b;return this.a=e,this.b=n,this.c=s,this.d=o,this.e=r,this.f=h,this},e.prototype.inverse=e.prototype.reverse=function(){if(this._dirty){this._dirty=!1,this.inversed=this.inversed||new e;var t=this.a*this.d-this.b*this.c;this.inversed.a=this.d/t,this.inversed.b=-this.b/t,this.inversed.c=-this.c/t,this.inversed.d=this.a/t,this.inversed.e=(this.c*this.f-this.e*this.d)/t,this.inversed.f=(this.e*this.b-this.a*this.f)/t}return this.inversed},e.prototype.map=function(t,i){return(i=i||{}).x=this.a*t.x+this.c*t.y+this.e,i.y=this.b*t.x+this.d*t.y+this.f,i},e.prototype.mapX=function(t,i){return"object"==typeof t&&(i=t.y,t=t.x),this.a*t+this.c*i+this.e},e.prototype.mapY=function(t,i){return"object"==typeof t&&(i=t.y,t=t.x),this.b*t+this.d*i+this.f},t.exports=e},function(t,i,e){t.exports=e(0),t.exports.Matrix=e(10),t.exports.Texture=e(8),e(13),e(15),e(16),e(3),e(4),e(18)},function(t,i){t.exports=function(){var t=0;function i(i,e){return t+=e="number"==typeof e&&e>=1?e:1,function(){i&&i.apply(this,arguments),e>0&&(e--,t--,n())}}var e=[];function n(){if(0===t)for(;e.length;)setTimeout(e.shift(),0)}return i.then=function(i){0===t?setTimeout(i,0):e.push(i)},i}},function(t,i,e){"undefined"==typeof DEBUG&&(DEBUG=!0);var n=e(0),s=e(8),o=e(6),r=e(2),h=e(7),a=e(14),u={},c=[];function f(t){f._super.call(this);var i=this;d(t,"filter"),d(t,"cutouts"),d(t,"sprites"),d(t,"factory");var e=t.map||t.filter,n=t.ppu||t.ratio||1,s=t.trim||0,r=t.textures,u=t.factory,c=t.cutouts||t.sprites;function l(t){if(!t||h.fn(t.draw))return t;t=o({},t),h.fn(e)&&(t=e(t)),1!=n&&(t.x*=n,t.y*=n,t.width*=n,t.height*=n,t.top*=n,t.bottom*=n,t.left*=n,t.right*=n),0!=s&&(t.x+=s,t.y+=s,t.width-=2*s,t.height-=2*s,t.top-=s,t.bottom-=s,t.left-=s,t.right-=s);var r=i.pipe();return r.top=t.top,r.bottom=t.bottom,r.left=t.left,r.right=t.right,r.src(t.x,t.y,t.width,t.height),r}function p(t){if(r){if(h.fn(r))return r(t);if(h.hash(r))return r[t]}if(c){for(var i=null,e=0,n=0;n<c.length;n++)a.startsWith(c[n].name,t)&&(0===e?i=c[n]:1===e?i=[i,c[n]]:i.push(c[n]),e++);return 0===e&&h.fn(u)&&(i=function(i){return u(t+(i||""))}),i}}this.select=function(t){if(!t)return new _(this.pipe());var i=p(t);return i?new _(i,p,l):void 0}}n.atlas=function(t){var i=h.fn(t.draw)?t:new f(t);t.name&&(u[t.name]=i),c.push(i),d(t,"imagePath"),d(t,"imageRatio");var e=t.imagePath,s=t.imageRatio||1;return h.string(t.image)?e=t.image:h.hash(t.image)&&(e=t.image.src||t.image.url,s=t.image.ratio||s),e&&n.preload((function(t){e=n.resolve(e),DEBUG&&console.log("Loading atlas: "+e),n.config("image-loader")(e,(function(n){DEBUG&&console.log("Image loaded: "+e),i.src(n,s),t()}),(function(i){DEBUG&&console.log("Error loading atlas: "+e,i),t()}))})),i},f._super=s,f.prototype=r(f._super.prototype);var l=new s;l.x=l.y=l.width=l.height=0,l.pipe=l.src=l.dest=function(){return this},l.draw=function(){};var p=new _(l);function _(t,i,e){function n(t,s){return t?h.fn(t.draw)?t:h.hash(t)&&h.number(t.width)&&h.number(t.height)&&h.fn(e)?e(t):h.hash(t)&&h.defined(s)?n(t[s]):h.fn(t)?n(t(s)):h.array(t)?n(t[0]):h.string(t)&&h.fn(i)?n(i(t)):void 0:l}this.one=function(i){return n(t,i)},this.array=function(i){var e=h.array(i)?i:[];if(h.array(t))for(var s=0;s<t.length;s++)e[s]=n(t[s]);else e[0]=n(t);return e}}function d(t,i,e){i in t&&console.log(e?e.replace("%name",i):"'"+i+"' field of texture atlas is deprecated.")}n.texture=function(t){if(!h.string(t))return new _(t);var i,e,n=null;for((e=t.indexOf(":"))>0&&t.length>e+1&&(n=(i=u[t.slice(0,e)])&&i.select(t.slice(e+1))),!n&&(i=u[t])&&(n=i.select()),e=0;!n&&e<c.length;e++)n=c[e].select(t);return n||(console.error("Texture not found: "+t),n=p),n},t.exports=f},function(t,i){t.exports.startsWith=function(t,i){return"string"==typeof t&&"string"==typeof i&&t.substring(0,i.length)==i}},function(t,i,e){var n=e(0),s=e(7),o=0;function r(t,i){c(i),c(t),i.remove(),t._last&&(t._last._next=i,i._prev=t._last),i._parent=t,t._last=i,t._first||(t._first=i),i._parent._flag(i,!0),i._ts_parent=++o,t._ts_children=++o,t.touch()}function h(t,i){c(i),c(t),i.remove(),t._first&&(t._first._prev=i,i._next=t._first),i._parent=t,t._first=i,t._last||(t._last=i),i._parent._flag(i,!0),i._ts_parent=++o,t._ts_children=++o,t.touch()}function a(t,i){c(t),c(i),t.remove();var e=i._parent,n=i._prev;i._prev=t,n&&(n._next=t)||e&&(e._first=t),t._parent=e,t._prev=n,t._next=i,t._parent._flag(t,!0),t._ts_parent=++o,t.touch()}function u(t,i){c(t),c(i),t.remove();var e=i._parent,n=i._next;i._next=t,n&&(n._prev=t)||e&&(e._last=t),t._parent=e,t._prev=i,t._next=n,t._parent._flag(t,!0),t._ts_parent=++o,t.touch()}function c(t){if(t&&t instanceof n)return t;throw"Invalid node: "+t}n.prototype._label="",n.prototype._visible=!0,n.prototype._parent=null,n.prototype._next=null,n.prototype._prev=null,n.prototype._first=null,n.prototype._last=null,n.prototype._attrs=null,n.prototype._flags=null,n.prototype.toString=function(){return"["+this._label+"]"},n.prototype.id=function(t){return this.label(t)},n.prototype.label=function(t){return void 0===t?this._label:(this._label=t,this)},n.prototype.attr=function(t,i){return void 0===i?null!==this._attrs?this._attrs[t]:void 0:((null!==this._attrs?this._attrs:this._attrs={})[t]=i,this)},n.prototype.visible=function(t){return void 0===t?this._visible:(this._visible=t,this._parent&&(this._parent._ts_children=++o),this._ts_pin=++o,this.touch(),this)},n.prototype.hide=function(){return this.visible(!1)},n.prototype.show=function(){return this.visible(!0)},n.prototype.parent=function(){return this._parent},n.prototype.next=function(t){for(var i=this._next;i&&t&&!i._visible;)i=i._next;return i},n.prototype.prev=function(t){for(var i=this._prev;i&&t&&!i._visible;)i=i._prev;return i},n.prototype.first=function(t){for(var i=this._first;i&&t&&!i._visible;)i=i._next;return i},n.prototype.last=function(t){for(var i=this._last;i&&t&&!i._visible;)i=i._prev;return i},n.prototype.visit=function(t,i){var e=t.reverse,n=t.visible;if(!t.start||!t.start(this,i)){for(var s,o=e?this.last(n):this.first(n);s=o;)if(o=e?s.prev(n):s.next(n),s.visit(t,i))return!0;return t.end&&t.end(this,i)}},n.prototype.append=function(t,i){if(s.array(t))for(var e=0;e<t.length;e++)r(this,t[e]);else if(void 0!==i)for(e=0;e<arguments.length;e++)r(this,arguments[e]);else void 0!==t&&r(this,t);return this},n.prototype.prepend=function(t,i){if(s.array(t))for(var e=t.length-1;e>=0;e--)h(this,t[e]);else if(void 0!==i)for(e=arguments.length-1;e>=0;e--)h(this,arguments[e]);else void 0!==t&&h(this,t);return this},n.prototype.appendTo=function(t){return r(t,this),this},n.prototype.prependTo=function(t){return h(t,this),this},n.prototype.insertNext=function(t,i){if(s.array(t))for(var e=0;e<t.length;e++)u(t[e],this);else if(void 0!==i)for(e=0;e<arguments.length;e++)u(arguments[e],this);else void 0!==t&&u(t,this);return this},n.prototype.insertPrev=function(t,i){if(s.array(t))for(var e=t.length-1;e>=0;e--)a(t[e],this);else if(void 0!==i)for(e=arguments.length-1;e>=0;e--)a(arguments[e],this);else void 0!==t&&a(t,this);return this},n.prototype.insertAfter=function(t){return u(this,t),this},n.prototype.insertBefore=function(t){return a(this,t),this},n.prototype.remove=function(t,i){if(void 0!==t){if(s.array(t))for(var e=0;e<t.length;e++)c(t[e]).remove();else if(void 0!==i)for(e=0;e<arguments.length;e++)c(arguments[e]).remove();else c(t).remove();return this}return this._prev&&(this._prev._next=this._next),this._next&&(this._next._prev=this._prev),this._parent&&(this._parent._first===this&&(this._parent._first=this._next),this._parent._last===this&&(this._parent._last=this._prev),this._parent._flag(this,!1),this._parent._ts_children=++o,this._parent.touch()),this._prev=this._next=this._parent=null,this._ts_parent=++o,this},n.prototype.empty=function(){for(var t,i=this._first;t=i;)i=t._next,t._prev=t._next=t._parent=null,this._flag(t,!1);return this._first=this._last=null,this._ts_children=++o,this.touch(),this},n.prototype.touch=function(){return this._ts_touch=++o,this._parent&&this._parent.touch(),this},n.prototype._flag=function(t,i){if(void 0===i)return null!==this._flags&&this._flags[t]||0;if("string"==typeof t&&(i?(this._flags=this._flags||{},!this._flags[t]&&this._parent&&this._parent._flag(t,!0),this._flags[t]=(this._flags[t]||0)+1):this._flags&&this._flags[t]>0&&(1==this._flags[t]&&this._parent&&this._parent._flag(t,!1),this._flags[t]=this._flags[t]-1)),"object"==typeof t&&t._flags)for(var e in t._flags)t._flags[e]>0&&this._flag(e,i);return this},n.prototype.hitTest=function(t){return!!this.attr("spy")||t.x>=0&&t.x<=this._pin._width&&t.y>=0&&t.y<=this._pin._height},t.exports=n},function(t,i,e){e(17)(e(0).prototype,(function(t,i,e){t._flag(i,e)}))},function(t,i){t.exports=function(t,i){t._listeners=null,t.on=t.listen=function(t,e){if(!t||!t.length||"function"!=typeof e)return this;if(null===this._listeners&&(this._listeners={}),t=("string"!=typeof t&&"function"==typeof t.join?t.join(" "):t).match(/\S+/g))for(var n=0;n<t.length;n++){var s=t[n];this._listeners[s]=this._listeners[s]||[],this._listeners[s].push(e),"function"==typeof i&&i(this,s,!0)}return this},t.off=function(t,e){if(!t||!t.length||"function"!=typeof e)return this;if(null===this._listeners)return this;if(t=("string"!=typeof t&&"function"==typeof t.join?t.join(" "):t).match(/\S+/g))for(var n=0;n<t.length;n++){var s,o=t[n],r=this._listeners[o];r&&(s=r.indexOf(e))>=0&&(r.splice(s,1),r.length||delete this._listeners[o],"function"==typeof i&&i(this,o,!1))}return this},t.listeners=function(t){return this._listeners&&this._listeners[t]},t.publish=function(t,i){var e=this.listeners(t);if(!e||!e.length)return 0;for(var n=0;n<e.length;n++)e[n].apply(this,i);return e.length},t.trigger=function(t,i){return this.publish(t,i),this}}},function(t,i,e){var n=e(0);e(3),e(4);var s=e(5),o=e(2),r=e(6);function h(t,i){h._super.call(this),this.label("Root");var e=!0,n=this,o=0,r=function(h){if(!0!==e){s.tick=s.node=s.draw=0;var a=o||h,u=h-a;o=h;var c=n._tick(u,h,a);n._mo_touch!=n._ts_touch?(n._mo_touch=n._ts_touch,i(n),t(r)):c?t(r):e=!0,s.fps=u?1e3/u:0}};this.start=function(){return this.resume()},this.resume=function(){return e&&(this.publish("resume"),e=!1,t(r)),this},this.pause=function(){return e||this.publish("pause"),e=!0,this},this.touch_root=this.touch,this.touch=function(){return this.resume(),this.touch_root()}}h._super=n,h.prototype=o(h._super.prototype),n.root=function(t,i){return new h(t,i)},h.prototype.background=function(t){return this},h.prototype.viewport=function(t,i,e){if(void 0===t)return r({},this._viewport);this._viewport={width:t,height:i,ratio:e||1},this.viewbox();var n=r({},this._viewport);return this.visit({start:function(t){if(!t._flag("viewport"))return!0;t.publish("viewport",[n])}}),this},h.prototype.viewbox=function(t,i,e){"number"==typeof t&&"number"==typeof i&&(this._viewbox={width:t,height:i,mode:/^(in|out|in-pad|out-crop)$/.test(e)?e:"in-pad"});var n=this._viewbox,s=this._viewport;return s&&n?(this.pin({width:n.width,height:n.height}),this.scaleTo(s.width,s.height,n.mode)):s&&this.pin({width:s.width,height:s.height}),this}},function(t,i,e){var n=e(0),s=e(8);n.canvas=function(t,i,e){"string"==typeof t?"object"==typeof i||("function"==typeof i&&(e=i),i={}):("function"==typeof t&&(e=t),i={},t="2d");var n=document.createElement("canvas"),o=n.getContext(t,i),r=new s(n);return r.context=function(){return o},r.size=function(t,i,e){return e=e||1,n.width=t*e,n.height=i*e,this.src(n,e),this},r.canvas=function(t){return"function"==typeof t?t.call(this,o):void 0===t&&"function"==typeof e&&e.call(this,o),this},"function"==typeof e&&e.call(r,o),r}},function(t,i,e){var n=e(0);e(3),e(4);var s=e(21),o=e(2);function r(){r._super.call(this),this.label("Image"),this._textures=[],this._image=null}t.exports=r,n.image=function(t){var i=new r;return t&&i.image(t),i},r._super=n,r.prototype=o(r._super.prototype),r.prototype.setImage=function(t,i,e){return this.image(t,i,e)},r.prototype.image=function(t){return this._image=n.texture(t).one(),this.pin("width",this._image?this._image.width:0),this.pin("height",this._image?this._image.height:0),this._textures[0]=this._image.pipe(),this._textures.length=1,this},r.prototype.tile=function(t){return this._repeat(!1,t),this},r.prototype.stretch=function(t){return this._repeat(!0,t),this},r.prototype._repeat=function(t,i){var e=this;function n(t,i,n,s,o,r,h,a,u){var c=e._textures.length>t?e._textures[t]:e._textures[t]=e._image.pipe();c.src(i,n,s,o),c.dest(r,h,a,u)}this.untick(this._repeatTicker),this.tick(this._repeatTicker=function(){if(this._mo_stretch!=this._pin._ts_transform){this._mo_stretch=this._pin._ts_transform;var e=this.pin("width"),o=this.pin("height");this._textures.length=s(this._image,e,o,t,i,n)}})}},function(t,i){t.exports=function(t,i,e,n,s,o){var r=t.width,h=t.height,a=t.left,u=t.right,c=t.top,f=t.bottom;r=r-(a="number"==typeof a&&a==a?a:0)-(u="number"==typeof u&&u==u?u:0),h=h-(c="number"==typeof c&&c==c?c:0)-(f="number"==typeof f&&f==f?f:0),s||(i=Math.max(i-a-u,0),e=Math.max(e-c-f,0));var l=0;if(c>0&&a>0&&o(l++,0,0,a,c,0,0,a,c),f>0&&a>0&&o(l++,0,h+c,a,f,0,e+c,a,f),c>0&&u>0&&o(l++,r+a,0,u,c,i+a,0,u,c),f>0&&u>0&&o(l++,r+a,h+c,u,f,i+a,e+c,u,f),n)c>0&&o(l++,a,0,r,c,a,0,i,c),f>0&&o(l++,a,h+c,r,f,a,e+c,i,f),a>0&&o(l++,0,c,a,h,0,c,a,e),u>0&&o(l++,r+a,c,u,h,i+a,c,u,e),o(l++,a,c,r,h,a,c,i,e);else for(var p,_=a,d=i;d>0;){p=Math.min(r,d),d-=r;for(var g,v=c,y=e;y>0;)g=Math.min(h,y),y-=h,o(l++,a,c,p,g,_,v,p,g),d<=0&&(a&&o(l++,0,c,a,g,0,v,a,g),u&&o(l++,r+a,c,u,g,_+p,v,u,g)),v+=g;c&&o(l++,a,0,p,c,_,0,p,c),f&&o(l++,a,h+c,p,f,_,v,p,f),_+=p}return l}},function(t,i,e){var n=e(0);e(3),e(4);var s=e(2),o=e(9);function r(){r._super.call(this),this.label("Anim"),this._textures=[],this._fps=n.Anim.FPS,this._ft=1e3/this._fps,this._time=-1,this._repeat=0,this._index=0,this._frames=[];var t=0;this.tick((function(i,e,n){if(!(this._time<0||this._frames.length<=1)){var s=t!=n;if(t=e,s)return!0;if(this._time+=i,this._time<this._ft)return!0;var o=this._time/this._ft|0;return this._time-=o*this._ft,this.moveFrame(o),!(this._repeat>0&&(this._repeat-=o)<=0)||(this.stop(),this._callback&&this._callback(),!1)}}),!1)}n.anim=function(t,i){var e=new r;return e.frames(t).gotoFrame(0),i&&e.fps(i),e},r._super=n,r.prototype=s(r._super.prototype),n.Anim={FPS:15},r.prototype.fps=function(t){return void 0===t?this._fps:(this._fps=t>0?t:n.Anim.FPS,this._ft=1e3/this._fps,this)},r.prototype.setFrames=function(t,i,e){return this.frames(t,i,e)},r.prototype.frames=function(t){return this._index=0,this._frames=n.texture(t).array(),this.touch(),this},r.prototype.length=function(){return this._frames?this._frames.length:0},r.prototype.gotoFrame=function(t,i){return this._index=0|o.rotate(t,this._frames.length),i=i||!this._textures[0],this._textures[0]=this._frames[this._index],i&&(this.pin("width",this._textures[0].width),this.pin("height",this._textures[0].height)),this.touch(),this},r.prototype.moveFrame=function(t){return this.gotoFrame(this._index+t)},r.prototype.repeat=function(t,i){return this._repeat=t*this._frames.length-1,this._callback=i,this.play(),this},r.prototype.play=function(t){return void 0!==t?(this.gotoFrame(t),this._time=0):this._time<0&&(this._time=0),this.touch(),this},r.prototype.stop=function(t){return this._time=-1,void 0!==t&&this.gotoFrame(t),this}},function(t,i,e){var n=e(0);e(3),e(4);var s=e(2),o=e(7);function r(){r._super.call(this),this.label("String"),this._textures=[]}n.string=function(t){return(new r).frames(t)},r._super=n,r.prototype=s(r._super.prototype),r.prototype.setFont=function(t,i,e){return this.frames(t,i,e)},r.prototype.frames=function(t){return this._textures=[],"string"==typeof t?(t=n.texture(t),this._item=function(i){return t.one(i)}):"object"==typeof t?this._item=function(i){return t[i]}:"function"==typeof t&&(this._item=t),this},r.prototype.setValue=function(t,i,e){return this.value(t,i,e)},r.prototype.value=function(t){if(void 0===t)return this._value;if(this._value===t)return this;this._value=t,null===t?t="":"string"==typeof t||o.array(t)||(t=t.toString()),this._spacing=this._spacing||0;for(var i=0,e=0,n=0;n<t.length;n++){var s=this._textures[n]=this._item(t[n]);i+=n>0?this._spacing:0,s.dest(i,0),i+=s.width,e=Math.max(e,s.height)}return this.pin("width",i),this.pin("height",e),this._textures.length=t.length,this}},function(t,i,e){var n=e(0);e(3),e(4);e(2);n.row=function(t){return n.create().row(t).label("Row")},n.prototype.row=function(t){return this.sequence("row",t),this},n.column=function(t){return n.create().column(t).label("Row")},n.prototype.column=function(t){return this.sequence("column",t),this},n.sequence=function(t,i){return n.create().sequence(t,i).label("Sequence")},n.prototype.sequence=function(t,i){return this._padding=this._padding||0,this._spacing=this._spacing||0,this.untick(this._layoutTiker),this.tick(this._layoutTiker=function(){if(this._mo_seq!=this._ts_touch){this._mo_seq=this._ts_touch;var e=this._mo_seqAlign!=this._ts_children;this._mo_seqAlign=this._ts_children;for(var n,s=0,o=0,r=this.first(!0),h=!0;n=r;){r=n.next(!0),n.matrix(!0);var a=n.pin("boxWidth"),u=n.pin("boxHeight");"column"==t?(!h&&(o+=this._spacing),n.pin("offsetY")!=o&&n.pin("offsetY",o),s=Math.max(s,a),o+=u,e&&n.pin("alignX",i)):"row"==t&&(!h&&(s+=this._spacing),n.pin("offsetX")!=s&&n.pin("offsetX",s),s+=a,o=Math.max(o,u),e&&n.pin("alignY",i)),h=!1}s+=2*this._padding,o+=2*this._padding,this.pin("width")!=s&&this.pin("width",s),this.pin("height")!=o&&this.pin("height",o)}}),this},n.box=function(){return n.create().box().label("Box")},n.prototype.box=function(){return this._padding=this._padding||0,this.untick(this._layoutTiker),this.tick(this._layoutTiker=function(){if(this._mo_box!=this._ts_touch){this._mo_box=this._ts_touch;for(var t,i=0,e=0,n=this.first(!0);t=n;){n=t.next(!0),t.matrix(!0);var s=t.pin("boxWidth"),o=t.pin("boxHeight");i=Math.max(i,s),e=Math.max(e,o)}i+=2*this._padding,e+=2*this._padding,this.pin("width")!=i&&this.pin("width",i),this.pin("height")!=e&&this.pin("height",e)}}),this},n.layer=function(){return n.create().layer().label("Layer")},n.prototype.layer=function(){return this.untick(this._layoutTiker),this.tick(this._layoutTiker=function(){var t=this.parent();if(t){var i=t.pin("width");this.pin("width")!=i&&this.pin("width",i);var e=t.pin("height");this.pin("height")!=e&&this.pin("height",e)}},!0),this},n.prototype.padding=function(t){return this._padding=t,this},n.prototype.spacing=function(t){return this._spacing=t,this}},function(t,i,e){var n=e(26),s=e(0),o=e(3);function r(t,i,e){this._end={},this._duration=i||400,this._delay=e||0,this._owner=t,this._time=0}function h(t,i,e,n){"number"==typeof t.pin(e)?i[e]=n:"number"==typeof t.pin(e+"X")&&"number"==typeof t.pin(e+"Y")&&(i[e+"X"]=n,i[e+"Y"]=n)}s.prototype.tween=function(t,i,e){if("number"!=typeof t?(e=t,i=0,t=0):"number"!=typeof i&&(e=i,i=0),!this._tweens){this._tweens=[];var n=0;this.tick((function(t,i,e){if(this._tweens.length){var s=n!=e;if(n=i,s)return!0;var o=this._tweens[0],r=o.tick(this,t,i,e);if(r&&o===this._tweens[0]&&this._tweens.shift(),"function"==typeof r)try{r.call(this)}catch(t){console.log(t)}return"object"==typeof r&&this._tweens.unshift(r),!0}}),!0)}this.touch(),e||(this._tweens.length=0);var s=new r(this,t,i);return this._tweens.push(s),s},r.prototype.tick=function(t,i,e,n){if(this._time+=i,!(this._time<this._delay)){var s,o,r=this._time-this._delay;if(!this._start)for(var h in this._start={},this._end)this._start[h]=this._owner.pin(h);r<this._duration?(s=r/this._duration,o=!1):(s=1,o=!0),"function"==typeof this._easing&&(s=this._easing(s));var a=1-s;for(var h in this._end)this._owner.pin(h,this._start[h]*a+this._end[h]*s);return o?this._next||this._done||!0:void 0}},r.prototype.tween=function(t,i){return this._next=new r(this._owner,t,i)},r.prototype.duration=function(t){return this._duration=t,this},r.prototype.delay=function(t){return this._delay=t,this},r.prototype.ease=function(t){return this._easing=n(t),this},r.prototype.done=function(t){return this._done=t,this},r.prototype.hide=function(){return this.done((function(){this.hide()})),this},r.prototype.remove=function(){return this.done((function(){this.remove()})),this},r.prototype.pin=function(t,i){if("object"==typeof t)for(var e in t)h(this._owner,this._end,e,t[e]);else void 0!==i&&h(this._owner,this._end,t,i);return this},o._add_shortcuts(r),r.prototype.then=function(t){return this.done(t),this},r.prototype.clear=function(t){return this},t.exports=r},function(t,i){function e(t){return t}var n={},s={},o={};function r(t){if("function"==typeof t)return t;if("string"!=typeof t)return e;var i=n[t];if(i)return i;var r=/^(\w+)(-(in|out|in-out|out-in))?(\((.*)\))?$/i.exec(t);if(!r||!r.length)return e;var h=o[r[1]],a=s[r[3]],u=r[5];return i=h&&h.fn?h.fn:h&&h.fc?h.fc.apply(h.fc,u&&u.replace(/\s+/,"").split(",")):e,a&&(i=a.fn(i)),n[t]=i,i}r.add=function(t){for(var i=(t.name||t.mode).split(/\s+/),e=0;e<i.length;e++){var n=i[e];n&&((t.name?o:s)[n]=t)}},r.add({mode:"in",fn:function(t){return t}}),r.add({mode:"out",fn:function(t){return function(i){return 1-t(1-i)}}}),r.add({mode:"in-out",fn:function(t){return function(i){return i<.5?t(2*i)/2:1-t(2*(1-i))/2}}}),r.add({mode:"out-in",fn:function(t){return function(i){return i<.5?1-t(2*(1-i))/2:t(2*i)/2}}}),r.add({name:"linear",fn:function(t){return t}}),r.add({name:"quad",fn:function(t){return t*t}}),r.add({name:"cubic",fn:function(t){return t*t*t}}),r.add({name:"quart",fn:function(t){return t*t*t*t}}),r.add({name:"quint",fn:function(t){return t*t*t*t*t}}),r.add({name:"sin sine",fn:function(t){return 1-Math.cos(t*Math.PI/2)}}),r.add({name:"exp expo",fn:function(t){return 0==t?0:Math.pow(2,10*(t-1))}}),r.add({name:"circle circ",fn:function(t){return 1-Math.sqrt(1-t*t)}}),r.add({name:"bounce",fn:function(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375}}),r.add({name:"poly",fc:function(t){return function(i){return Math.pow(i,t)}}}),r.add({name:"elastic",fc:function(t,i){t=t||1;var e=(i=i||.45)/(2*Math.PI)*Math.asin(1/t);return function(n){return 1+t*Math.pow(2,-10*n)*Math.sin((n-e)*(2*Math.PI)/i)}}}),r.add({name:"back",fc:function(t){return t=void 0!==t?t:1.70158,function(i){return i*i*((t+1)*i-t)}}}),t.exports=r},function(t,i,e){function n(t,i){if(this instanceof n){var e=t.viewport().ratio||1;t.on("viewport",(function(t){e=t.ratio||e})),this.x=0,this.y=0,this.toString=function(){return(0|this.x)+"x"+(0|this.y)},this.locate=function(t){!function(t,i,e){i.touches&&i.touches.length?(e.x=i.touches[0].clientX,e.y=i.touches[0].clientY):(e.x=i.clientX,e.y=i.clientY);var n=t.getBoundingClientRect();e.x-=n.left,e.y-=n.top,e.x-=0|t.clientLeft,e.y-=0|t.clientTop}(i,t,this),this.x*=e,this.y*=e},this.lookup=function(i,e){this.type=i,this.root=t,this.event=null,e.length=0,this.collect=e,this.root.visit(this.visitor,this)},this.publish=function(i,e,n){if(this.type=i,this.root=t,this.event=e,this.collect=!1,this.timeStamp=Date.now(),"mousemove"!==i&&"touchmove"!==i&&DEBUG&&console.log(this.type+" "+this),n){for(;n.length&&!this.visitor.end(n.shift(),this););n.length=0}else this.root.visit(this.visitor,this)},this.visitor={reverse:!0,visible:!0,start:function(t,i){return!t._flag(i.type)},end:function(t,i){s.raw=i.event,s.type=i.type,s.timeStamp=i.timeStamp,s.abs.x=i.x,s.abs.y=i.y;var e=t.listeners(i.type);if(e&&(t.matrix().inverse().map(i,s),(t===i.root||t.hitTest(s))&&(i.collect&&i.collect.push(t),i.event))){for(var n=!1,o=0;o<e.length;o++)n=!!e[o].call(t,s)||n;return n}}}}}"undefined"==typeof DEBUG&&(DEBUG=!0),e(0)._load((function(t,i){n.subscribe(t,i)})),n.CLICK="click",n.START="touchstart mousedown",n.MOVE="touchmove mousemove",n.END="touchend mouseup",n.CANCEL="touchcancel mousecancel",n.subscribe=function(t,i){if(!t.mouse){t.mouse=new n(t,i),i.addEventListener("touchstart",o),i.addEventListener("touchend",h),i.addEventListener("touchmove",r),i.addEventListener("touchcancel",a),i.addEventListener("mousedown",o),i.addEventListener("mouseup",h),i.addEventListener("mousemove",r),document.addEventListener("mouseup",a),window.addEventListener("blur",a);var e=[],s=[]}function o(i){i.preventDefault(),t.mouse.locate(i),t.mouse.publish(i.type,i),t.mouse.lookup("click",e),t.mouse.lookup("mousecancel",s)}function r(i){i.preventDefault(),t.mouse.locate(i),t.mouse.publish(i.type,i)}function h(i){i.preventDefault(),t.mouse.publish(i.type,i),e.length&&t.mouse.publish("click",i,e),s.length=0}function a(i){s.length&&t.mouse.publish("mousecancel",i,s),e.length=0}};var s={},o={};function r(t,i,e){Object.defineProperty(t,i,{value:e})}r(s,"clone",(function(t){return(t=t||{}).x=this.x,t.y=this.y,t})),r(s,"toString",(function(){return(0|this.x)+"x"+(0|this.y)+" ("+this.abs+")"})),r(s,"abs",o),r(o,"clone",(function(t){return(t=t||{}).x=this.x,t.y=this.y,t})),r(o,"toString",(function(){return(0|this.x)+"x"+(0|this.y)})),t.exports=n},function(t,i,e){"undefined"==typeof DEBUG&&(DEBUG=!0);var n,s=e(0);s._supported=!(!(n=document.createElement("canvas")).getContext||!n.getContext("2d")),window.addEventListener("load",(function(){DEBUG&&console.log("On load."),s._supported&&s.start()}),!1),s.config({"app-loader":function(t,i){var e,n=(i=i||{}).canvas,o=null,r=!1,h=0,a=0;"string"==typeof n&&(n=document.getElementById(n));n||(n=document.getElementById("cutjs")||document.getElementById("stage"));if(!n){r=!0,DEBUG&&console.log("Creating Canvas..."),(n=document.createElement("canvas")).style.position="absolute",n.style.top="0",n.style.left="0";var u=document.body;u.insertBefore(n,u.firstChild)}o=n.getContext("2d");var c=window.devicePixelRatio||1,f=o.webkitBackingStorePixelRatio||o.mozBackingStorePixelRatio||o.msBackingStorePixelRatio||o.oBackingStorePixelRatio||o.backingStorePixelRatio||1;e=c/f;var l=window.requestAnimationFrame||window.msRequestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.oRequestAnimationFrame||function(t){return window.setTimeout(t,1e3/60)};DEBUG&&console.log("Creating stage...");var p=s.root(l,_);function _(){o.setTransform(1,0,0,1,0,0),o.clearRect(0,0,h,a),p.render(o)}function d(){r?(h=window.innerWidth>0?window.innerWidth:screen.width,a=window.innerHeight>0?window.innerHeight:screen.height,n.style.width=h+"px",n.style.height=a+"px"):(h=n.clientWidth,a=n.clientHeight),h*=e,a*=e,n.width===h&&n.height===a||(n.width=h,n.height=a,DEBUG&&console.log("Resize: "+h+" x "+a+" / "+e),p.viewport(h,a,e),_())}p.background=function(t){return n.style.backgroundColor=t,this},t(p,n),d(),window.addEventListener("resize",d,!1),window.addEventListener("orientationchange",d,!1)},"image-loader":function(t,i,e){DEBUG&&console.log("Loading image: "+t);var n=new Image;n.onload=function(){i(n)},n.onerror=e,n.src=t}})},function(t,i,e){"use strict";e.r(i);var n=e(1),s=e.n(n);var o=[{image:"static/shuttle.png",textures:{shuttle:{x:0,y:0,width:52,height:52}}},{image:"static/laser-blue.png",textures:{bullet:{x:0,y:0,width:15,height:30}}},{image:"static/asteroid-brown.png",textures:{rock:{x:0,y:0,width:64,height:64}}},{image:{src:"static/explosionSpriteSheet.png"},textures:{explosion:[{x:0,y:0,width:52,height:52},{x:52,y:0,width:52,height:52},{x:104,y:0,width:52,height:52},{x:156,y:0,width:52,height:52},{x:208,y:0,width:52,height:52},{x:0,y:52,width:52,height:52},{x:52,y:52,width:52,height:52},{x:104,y:52,width:52,height:52},{x:156,y:52,width:52,height:52},{x:208,y:52,width:52,height:52},{x:0,y:104,width:52,height:52},{x:52,y:104,width:52,height:52}]}},{textures:{text:function(t){return t+="",s.a.canvas((function(i){this.size(16,24,2),i.scale(2,2),i.font="bold 24px monospace",i.fillStyle="#ddd",i.textBaseline="top",i.fillText(t,0,1)}))}}}];let r={dtCoefficient:.001,shuttleRotation:4,shuttleAcceleration:400,shuttleMaxVelocity:600,bulletVelocity:1e3,bulletDecay:1300,newRockChance:.4,rockMaxVelocity:95,rockMaxScale:3,rockSpinSpeed:1,initTimeLimit:1,viewbox:{width:2436,height:1125},keyBindings:{32:"fire",38:"accelerate",37:"turnLeft",40:null,39:"turnRight",87:"accelerate",65:"turnLeft",83:null,68:"turnRight"},mouseBindings:{move:"focus",click:"accelerate",middleClick:null,rightClick:"fire"},actionIntervals:{fire:750,focus:100}};function h(){return performance.now()}class a{constructor(t=r.keyBindings,i=r.mouseBindings,e="Input"){this.keyBindings=t,this.mouseBindings=i,this.source=e,this.valueCache={},this.timeouts={},this.firstTouchId=null,this.secondTouchId=null}start(t){document.onkeydown=i=>this.onKeyDown(t,i),document.onkeyup=i=>this.onKeyUp(t,i),document.onmouseout=i=>this.onMouseOut(t,i),document.oncontextmenu=t=>!1,t.on("mousemove",i=>this.onMouseMove(t,i)),t.on("touchmove",i=>this.onTouchMove(t,i)),t.on("mousedown",i=>this.onMouseStart(t,i)),t.on("touchstart",i=>this.onTouchStart(t,i)),t.on(["mouseup","mousecancel"],i=>this.onMouseEnd(t,i)),t.on(["touchend","touchcancel"],i=>this.onTouchEnd(t,i))}setAction(t,i,e,n=h){if(i&&!e.equals(this.valueCache[i])){this.valueCache[i]=e;let s=r.actionIntervals[i];s?this.startInterval(t,i,s,n,e):t.publish(`${this.source}.action.${i}`,[n(),e])}}startInterval(t,i,e,n,s){this.timeouts[i]||(t.publish(`${this.source}.action.${i}`,[n(),s]),this.delayNextPublish(t,i,e,n,s))}delayNextPublish(t,i,e,n,s){this.timeouts[i]=setTimeout(()=>{this.timeouts[i]=void 0;let o=this.valueCache[i];o&&!o.equals(s)&&this.startInterval(t,i,e,n,o)},e)}clearAction(t,i,e=h){i&&this.valueCache[i]&&(this.valueCache[i]=void 0,t.publish(`${this.source}.action.${i}.clear`,[e()]))}onKeyDown(t,i){this.setAction(t,this.keyBindings[i.keyCode],new u)}onKeyUp(t,i){this.clearAction(t,this.keyBindings[i.keyCode])}onMouseMove(t,i){let e=i.x-t.width()/2,n=i.y-t.height()/2,s=new c(e,n);this.setAction(t,this.mouseBindings.move,s)}onMouseOut(t,i){this.mouseMovePoint=null,this.clearAction(t,this.mouseBindings.move)}onMouseStart(t,i){let e=i.raw.button;0===e?this.setAction(t,this.mouseBindings.click,new u):1===e?this.setAction(t,this.mouseBindings.middleClick,new u):2===e&&this.setAction(t,this.mouseBindings.rightClick,new u)}onMouseEnd(t,i){let e=i.raw.button;0===e?this.clearAction(t,this.mouseBindings.click):1===e?this.clearAction(t,this.mouseBindings.middleClick):2===e&&this.clearAction(t,this.mouseBindings.rightClick)}onTouchMove(t,i){this.isTouchChanged(i,this.firstTouchId)&&this.onMouseMove(t,i)}onTouchStart(t,i){let e=i.raw.changedTouches,n=0;null===this.firstTouchId&&(this.firstTouchId=e[n++].identifier,this.onTouchMove(t,i)),null===this.secondTouchId&&e[n]&&(this.secondTouchId=e[n++].identifier,this.setAction(t,this.mouseBindings.click,new u))}onTouchEnd(t,i){this.isTouchChanged(i,this.firstTouchId)&&(this.firstTouchId=null,this.clearAction(t,this.mouseBindings.move)),this.isTouchChanged(i,this.secondTouchId)&&(this.secondTouchId=null,this.clearAction(t,this.mouseBindings.click))}isTouchChanged(t,i){if(i)for(let e of t.raw.changedTouches)if(e.identifier===i)return!0;return!1}}class u{constructor(){this.active=!0}equals(t){return t instanceof u}}class c{constructor(t,i){this.x=t,this.y=i}equals(t){return t&&this.x===t.x&&this.y===t.y}}class f{constructor(t,i,e){this.node=t,this.source=i,this.actions=e,this.times={},this.values={};for(let t of e)this.hasOwnProperty(t)||Object.defineProperty(this,t,{get:()=>this.get(t)})}start(t){for(let i of this.actions)t.on(`${this.source}.action.${i}`,(t,e)=>{this.node.publish(`action.${i}`,[t,e]),this.times[i]=t,this.values[i]=e}),t.on(`${this.source}.action.${i}.clear`,t=>{this.node.publish(`action.${i}.clear`,[t]),this.times[i]=t,this.values[i]=void 0})}get(t){return this.values[t]}getTime(t){return this.times[t]}on(t,i){this.node.on(`action.${t}`,i)}onClear(t,i){this.node.on(`action.${t}.clear`,i)}}let l=Math.PI,p=2*Math.PI;function _(t,i){return Math.sin(t)*i}function d(t,i){return-Math.cos(t)*i}function g(t,i,e=0,n=0){let s=t-e,o=i-n;return Math.sqrt(s*s+o*o)}function v(t){for(;t>=p;)t-=p;for(;t<0;)t+=p;return t}class y{constructor(t,i=0,e=0,n=0){this.node=t,this.offsetX=i,this.offsetY=e,this.rotation=n}start(t){this.node.appendTo(t),this.node.pin({align:.5,offsetX:this.offsetX,offsetY:this.offsetY,rotation:this.rotation}),this.node.tick(i=>this.tick(i,t))}tick(t,i){}get radius(){return this.node.width()*this.node.pin("scaleX")/2}collisionDetection(t){return g(this.offsetX,this.offsetY,t.offsetX,t.offsetY)<=this.radius+t.radius}remove(){this.node.remove()}moveTo(t,i){this.offsetX=t,this.offsetY=i,this.node.pin({offsetX:t,offsetY:i})}rotateTo(t){this.rotation=v(t),this.node.pin("rotation",t)}}class m extends y{constructor(t,i,e,n,s=0,o=0,r=0){super(t,i,e,n),this.velocityX=s,this.velocityY=o,this.spin=r}getRightEdge(t){return(this.node.width()+t.width())/2}getBottomEdge(t){return(this.node.height()+t.height())/2}moveBy(t,i,e){let n=e*r.dtCoefficient,s=t?t*n:0,o=i?i*n:0;0===s&&0===o||this.moveTo(this.offsetX+s,this.offsetY+o)}rotateBy(t,i){let e=t?t*(i*r.dtCoefficient):0;0!==e&&this.rotateTo(this.rotation+e)}accelerate(t,i,e,n){let s=n*r.dtCoefficient;if(this.velocityX+=_(t,i*s),this.velocityY+=d(t,i*s),e){let t=g(this.velocityX,this.velocityY);if(t>=e){let i=e/t;this.velocityX*=i,this.velocityY*=i}}}tick(t,i){super.tick(t,i),this.rotateBy(this.spin,t),this.moveBy(this.velocityX,this.velocityY,t);let e=this.getRightEdge(i),n=this.getBottomEdge(i);this.offsetX>=e?this.onLeave("right"):this.offsetX<=-e&&this.onLeave("left"),this.offsetY>=n?this.onLeave("bottom"):this.offsetY<=-n&&this.onLeave("top")}onLeave(t){}}class x extends m{constructor(t,i,e,n,o){let h=n+_(e,r.bulletVelocity),a=o+d(e,r.bulletVelocity);super(s.a.image("bullet"),t,i,e,h,a),this.expires=performance.now()+r.bulletDecay}tick(t,i){super.tick(t,i),performance.now()>=this.expires&&this.node.remove()}onLeave(t){"top"===t||"bottom"===t?this.moveTo(this.offsetX,-this.offsetY):"left"!==t&&"right"!==t||this.moveTo(-this.offsetX,this.offsetY)}}class w extends m{constructor(t,i){super(s.a.image("shuttle")),this.reloading=!1,this.rockMaker=t,this.actions=new f(this.node,i,["fire","focus","turnLeft","turnRight","accelerate"])}start(t){super.start(t),this.actions.start(t),this.actions.on("fire",i=>this.fireBullet(t,i)),this.actions.on("turnLeft",()=>this.turnLeft()),this.actions.onClear("turnLeft",()=>this.turnRight()),this.actions.on("turnRight",()=>this.turnRight()),this.actions.onClear("turnRight",()=>this.turnLeft())}tick(t,i){if(super.tick(t,i),this.actions.focus&&0===this.spin){let i=this.getFocusAngle(this.actions.focus),e=function(t,i){let e=v(i)-v(t);return e>l?e-p:e<-l?e+p:e}(this.rotation,i);this.rotateBy(e*r.shuttleRotation,t)}this.actions.accelerate&&this.accelerate(this.rotation,r.shuttleAcceleration,r.shuttleMaxVelocity,t);let e=this.rockMaker.rockSet;for(let t of e)this.collisionDetection(t)&&this.explode(i)}explode(t){this.node.remove(),new b(this.offsetX,this.offsetY).start(t)}turnLeft(){this.spin-=r.shuttleRotation}turnRight(){this.spin+=r.shuttleRotation}getFocusAngle(t){return function(t,i,e,n){let s=e-t,o=n-i,r=Math.atan(-s/o);return o<0?r:r+l}(this.offsetX,this.offsetY,t.x,t.y)}fireBullet(t,i){new x(this.offsetX,this.offsetY,this.rotation,this.velocityX,this.velocityY).start(t)}onLeave(t){"top"===t||"bottom"===t?this.moveTo(this.offsetX,-this.offsetY):"left"!==t&&"right"!==t||this.moveTo(-this.offsetX,this.offsetY)}}class b extends y{constructor(t,i){super(s.a.anim("explosion"),t,i)}start(t){super.start(t),this.node.repeat(1,()=>this.remove())}}class k{constructor(){this.numRocksStart=10,this.rocksPct=.6,this.rockSet=new Set}start(t){setInterval(()=>this.maybeMakeRocks(t),500)}maybeMakeRocks(t){if(Math.random()<r.newRockChance){let i=new M(t,this.rockSet);this.rockSet.add(i),i.start(t)}}}class M extends m{constructor(t,i){let e=t=>2*Math.random()*t-t,n=e(r.rockMaxVelocity),o=e(r.rockMaxVelocity),h=t.width()/2,a=e(t.height()/2);n>0&&(h=-h);let u=2*Math.random()*Math.PI,c=r.rockSpinSpeed,f=2*Math.random()*c-c;super(s.a.image("rock"),h,a,u,n,o,f),this.rockSet=i;let l=Math.random()*r.rockMaxScale;this.node.scale({x:l,y:l})}remove(){super.remove(),this.rockSet.delete(this)}onLeave(){this.remove()}}class X extends y{constructor(t,i,e,n){super(s.a.string("text"),i,e),this.timeLimit=t,this.shuttle=n}start(t){super.start(t),this.node.value(`${this.timeLimit}:00`),this.startCountDownTimer(t)}startCountDownTimer(t){var i;this.intervalID=setInterval((i=this,function(){i.updateCountDownTimer(t)}),1e3)}updateCountDownTimer(t){let i=this.getCurrentTime();i>0&&(i-1==0&&(this.shuttle.explode(t),clearInterval(this.intervalID)),this.setCountDownTimer(i-1))}getCurrentTime(){let[t,i]=this.node.value().split(":");return t=parseInt(t),i=parseInt(i),i+=60*t,i}setCountDownTimer(t){let i=Math.floor(t/60),e=t%60;this.node.value(`${i}:${e}`)}}o.forEach(t=>s()(t)),s()((function(t){let i=new a,e=new k,n=new w(e,i.source),s=new X(r.initTimeLimit,0,0,n);i.start(t),n.start(t),e.start(t),s.start(t),t.viewbox(r.viewbox.width,r.viewbox.height,r.viewbox.mode||"in")}))}]);