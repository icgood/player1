!function(t){var e={};function n(i){if(e[i])return e[i].exports;var r=e[i]={i:i,l:!1,exports:{}};return t[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)n.d(i,r,function(e){return t[e]}.bind(null,r));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=29)}([function(t,e,n){t.exports=n(11),t.exports.internal={},n(19),t.exports.internal.Image=n(20),n(22),n(23),n(24),n(25),t.exports.Mouse=n(27),t.exports.Math=n(9),t.exports._extend=n(6),t.exports._create=n(2),n(28)},function(t,e,n){"undefined"==typeof DEBUG&&(DEBUG=!0);var i=n(5),r=n(6),o=n(7),s=n(12);function u(t){if(!(this instanceof u))return o.fn(t)?u.app.apply(u,arguments):o.object(t)?u.atlas.apply(u,arguments):t;i.create++;for(var e=0;e<a.length;e++)a[e].call(this)}i.create=0;var a=[];u._init=function(t){a.push(t)};var c=[];u._load=function(t){c.push(t)};var h={};u.config=function(){if(1===arguments.length&&o.string(arguments[0]))return h[arguments[0]];1===arguments.length&&o.object(arguments[0])&&r(h,arguments[0]),2===arguments.length&&o.string(arguments[0])&&(arguments[0],arguments[1])};var f=[],l=[],p=!1,y=!1;u.app=function(t,e){if(p){DEBUG&&console.log("Creating app...");var n=u.config("app-loader");n((function(e,n){DEBUG&&console.log("Initing app...");for(var i=0;i<c.length;i++)c[i].call(this,e,n);t(e,n),l.push(e),DEBUG&&console.log("Starting app..."),e.start()}),e)}else f.push(arguments)};var _=s();u.preload=function(t){if("string"==typeof t){var e=u.resolve(t);/\.js($|\?|\#)/.test(e)&&(DEBUG&&console.log("Loading script: "+e),t=function(t){!function(t,e){var n=document.createElement("script");n.addEventListener("load",(function(){e()})),n.addEventListener("error",(function(n){e(n||"Error loading script: "+t)})),n.src=t,n.id="preload-"+Date.now(),document.body.appendChild(n)}(e,t)})}"function"==typeof t&&t(_())},u.start=function(t){DEBUG&&console.log("Starting..."),u.config(t),_.then((function(){for(DEBUG&&console.log("Loading apps..."),p=!0;f.length;){var t=f.shift();u.app.apply(u,t)}}))},u.pause=function(){if(!y){y=!0;for(var t=l.length-1;t>=0;t--)l[t].pause()}},u.resume=function(){if(y){y=!1;for(var t=l.length-1;t>=0;t--)l[t].resume()}},u.create=function(){return new u},u.resolve=function(){if("undefined"==typeof window||"undefined"==typeof document)return function(t){return t};var t=document.getElementsByTagName("script");return function(e){if(/^\.\//.test(e)){var n=function(){if(document.currentScript)return document.currentScript.src;var e;try{var n=new Error;if(!n.stack)throw n;e=n.stack}catch(n){e=n.stack}if("string"==typeof e)for(var i=(e=e.split("\n")).length;i--;){var r=e[i].match(/(\w+\:\/\/[^/]*?\/.+?)(:\d+)(:\d+)?/);if(r)return r[1]}if(t.length&&"readyState"in t[0])for(i=t.length;i--;)if("interactive"===t[i].readyState)return t[i].src;return location.href}();e=n.substring(0,n.lastIndexOf("/")+1)+e.substring(2)}return e}}(),t.exports=u},function(t,e){if("function"==typeof Object.create)t.exports=function(t,e){return Object.create.call(Object,t,e)};else{function n(){}t.exports=function(t,e){if(e)throw Error("Second argument is not supported!");if("object"!=typeof t||null===t)throw Error("Invalid prototype!");return n.prototype=t,new n}}},function(t,e,n){var i=n(1),r=n(10),o=0;function s(t){this._owner=t,this._parent=null,this._relativeMatrix=new r,this._absoluteMatrix=new r,this.reset()}i._init((function(){this._pin=new s(this)})),i.prototype.matrix=function(t){return!0===t?this._pin.relativeMatrix():this._pin.absoluteMatrix()},i.prototype.pin=function(t,e){return"object"==typeof t?(this._pin.set(t),this):"string"==typeof t?void 0===e?this._pin.get(t):(this._pin.set(t,e),this):void 0===t?this._pin:void 0},s.prototype.reset=function(){this._textureAlpha=1,this._alpha=1,this._width=0,this._height=0,this._scaleX=1,this._scaleY=1,this._skewX=0,this._skewY=0,this._rotation=0,this._pivoted=!1,this._pivotX=null,this._pivotY=null,this._handled=!1,this._handleX=0,this._handleY=0,this._aligned=!1,this._alignX=0,this._alignY=0,this._offsetX=0,this._offsetY=0,this._boxX=0,this._boxY=0,this._boxWidth=this._width,this._boxHeight=this._height,this._ts_translate=++o,this._ts_transform=++o,this._ts_matrix=++o},s.prototype._update=function(){return this._parent=this._owner._parent&&this._owner._parent._pin,this._handled&&this._mo_handle!=this._ts_transform&&(this._mo_handle=this._ts_transform,this._ts_translate=++o),this._aligned&&this._parent&&this._mo_align!=this._parent._ts_transform&&(this._mo_align=this._parent._ts_transform,this._ts_translate=++o),this},s.prototype.toString=function(){return this._owner+" ("+(this._parent?this._parent._owner:null)+")"},s.prototype.absoluteMatrix=function(){this._update();var t=Math.max(this._ts_transform,this._ts_translate,this._parent?this._parent._ts_matrix:0);if(this._mo_abs==t)return this._absoluteMatrix;this._mo_abs=t;var e=this._absoluteMatrix;return e.reset(this.relativeMatrix()),this._parent&&e.concat(this._parent._absoluteMatrix),this._ts_matrix=++o,e},s.prototype.relativeMatrix=function(){this._update();var t=Math.max(this._ts_transform,this._ts_translate,this._parent?this._parent._ts_transform:0);if(this._mo_rel==t)return this._relativeMatrix;this._mo_rel=t;var e,n,i=this._relativeMatrix;(i.identity(),this._pivoted&&i.translate(-this._pivotX*this._width,-this._pivotY*this._height),i.scale(this._scaleX,this._scaleY),i.skew(this._skewX,this._skewY),i.rotate(this._rotation),this._pivoted&&i.translate(this._pivotX*this._width,this._pivotY*this._height),this._pivoted)?(this._boxX=0,this._boxY=0,this._boxWidth=this._width,this._boxHeight=this._height):(i.a>0&&i.c>0||i.a<0&&i.c<0?(e=0,n=i.a*this._width+i.c*this._height):(e=i.a*this._width,n=i.c*this._height),e>n?(this._boxX=n,this._boxWidth=e-n):(this._boxX=e,this._boxWidth=n-e),i.b>0&&i.d>0||i.b<0&&i.d<0?(e=0,n=i.b*this._width+i.d*this._height):(e=i.b*this._width,n=i.d*this._height),e>n?(this._boxY=n,this._boxHeight=e-n):(this._boxY=e,this._boxHeight=n-e));return this._x=this._offsetX,this._y=this._offsetY,this._x-=this._boxX+this._handleX*this._boxWidth,this._y-=this._boxY+this._handleY*this._boxHeight,this._aligned&&this._parent&&(this._parent.relativeMatrix(),this._x+=this._alignX*this._parent._width,this._y+=this._alignY*this._parent._height),i.translate(this._x,this._y),this._relativeMatrix},s.prototype.get=function(t){if("function"==typeof u[t])return u[t](this)},s.prototype.set=function(t,e){if("string"==typeof t)"function"==typeof a[t]&&void 0!==e&&a[t](this,e);else if("object"==typeof t)for(e in t)"function"==typeof a[e]&&void 0!==t[e]&&a[e](this,t[e],t);return this._owner&&(this._owner._ts_pin=++o,this._owner.touch()),this};var u={alpha:function(t){return t._alpha},textureAlpha:function(t){return t._textureAlpha},width:function(t){return t._width},height:function(t){return t._height},boxWidth:function(t){return t._boxWidth},boxHeight:function(t){return t._boxHeight},scaleX:function(t){return t._scaleX},scaleY:function(t){return t._scaleY},skewX:function(t){return t._skewX},skewY:function(t){return t._skewY},rotation:function(t){return t._rotation},pivotX:function(t){return t._pivotX},pivotY:function(t){return t._pivotY},offsetX:function(t){return t._offsetX},offsetY:function(t){return t._offsetY},alignX:function(t){return t._alignX},alignY:function(t){return t._alignY},handleX:function(t){return t._handleX},handleY:function(t){return t._handleY}},a={alpha:function(t,e){t._alpha=e},textureAlpha:function(t,e){t._textureAlpha=e},width:function(t,e){t._width_=e,t._width=e,t._ts_transform=++o},height:function(t,e){t._height_=e,t._height=e,t._ts_transform=++o},scale:function(t,e){t._scaleX=e,t._scaleY=e,t._ts_transform=++o},scaleX:function(t,e){t._scaleX=e,t._ts_transform=++o},scaleY:function(t,e){t._scaleY=e,t._ts_transform=++o},skew:function(t,e){t._skewX=e,t._skewY=e,t._ts_transform=++o},skewX:function(t,e){t._skewX=e,t._ts_transform=++o},skewY:function(t,e){t._skewY=e,t._ts_transform=++o},rotation:function(t,e){t._rotation=e,t._ts_transform=++o},pivot:function(t,e){t._pivotX=e,t._pivotY=e,t._pivoted=!0,t._ts_transform=++o},pivotX:function(t,e){t._pivotX=e,t._pivoted=!0,t._ts_transform=++o},pivotY:function(t,e){t._pivotY=e,t._pivoted=!0,t._ts_transform=++o},offset:function(t,e){t._offsetX=e,t._offsetY=e,t._ts_translate=++o},offsetX:function(t,e){t._offsetX=e,t._ts_translate=++o},offsetY:function(t,e){t._offsetY=e,t._ts_translate=++o},align:function(t,e){this.alignX(t,e),this.alignY(t,e)},alignX:function(t,e){t._alignX=e,t._aligned=!0,t._ts_translate=++o,this.handleX(t,e)},alignY:function(t,e){t._alignY=e,t._aligned=!0,t._ts_translate=++o,this.handleY(t,e)},handle:function(t,e){this.handleX(t,e),this.handleY(t,e)},handleX:function(t,e){t._handleX=e,t._handled=!0,t._ts_translate=++o},handleY:function(t,e){t._handleY=e,t._handled=!0,t._ts_translate=++o},resizeMode:function(t,e,n){n&&("in"==e?e="in-pad":"out"==e&&(e="out-crop"),c(t,n.resizeWidth,n.resizeHeight,e))},resizeWidth:function(t,e,n){n&&n.resizeMode||c(t,e,null)},resizeHeight:function(t,e,n){n&&n.resizeMode||c(t,null,e)},scaleMode:function(t,e,n){n&&c(t,n.scaleWidth,n.scaleHeight,e)},scaleWidth:function(t,e,n){n&&n.scaleMode||c(t,e,null)},scaleHeight:function(t,e,n){n&&n.scaleMode||c(t,null,e)},matrix:function(t,e){this.scaleX(t,e.a),this.skewX(t,e.c/e.d),this.skewY(t,e.b/e.a),this.scaleY(t,e.d),this.offsetX(t,e.e),this.offsetY(t,e.f),this.rotation(t,0)}};function c(t,e,n,i){var r="number"==typeof e,s="number"==typeof n,u="string"==typeof i;t._ts_transform=++o,r&&(t._scaleX=e/t._width_,t._width=t._width_),s&&(t._scaleY=n/t._height_,t._height=t._height_),r&&s&&u&&("out"==i||"out-crop"==i?t._scaleX=t._scaleY=Math.max(t._scaleX,t._scaleY):"in"!=i&&"in-pad"!=i||(t._scaleX=t._scaleY=Math.min(t._scaleX,t._scaleY)),"out-crop"!=i&&"in-pad"!=i||(t._width=e/t._scaleX,t._height=n/t._scaleY))}i.prototype.scaleTo=function(t,e,n){return"object"==typeof t&&(n=e,e=t.y,t=t.x),c(this._pin,t,e,n),this},s._add_shortcuts=function(t){t.prototype.size=function(t,e){return this.pin("width",t),this.pin("height",e),this},t.prototype.width=function(t){return void 0===t?this.pin("width"):(this.pin("width",t),this)},t.prototype.height=function(t){return void 0===t?this.pin("height"):(this.pin("height",t),this)},t.prototype.offset=function(t,e){return"object"==typeof t&&(e=t.y,t=t.x),this.pin("offsetX",t),this.pin("offsetY",e),this},t.prototype.rotate=function(t){return this.pin("rotation",t),this},t.prototype.skew=function(t,e){return"object"==typeof t?(e=t.y,t=t.x):void 0===e&&(e=t),this.pin("skewX",t),this.pin("skewY",e),this},t.prototype.scale=function(t,e){return"object"==typeof t?(e=t.y,t=t.x):void 0===e&&(e=t),this.pin("scaleX",t),this.pin("scaleY",e),this},t.prototype.alpha=function(t,e){return this.pin("alpha",t),void 0!==e&&this.pin("textureAlpha",e),this}},s._add_shortcuts(i),t.exports=s},function(t,e,n){var i=n(1);n(3);var r=n(5);i.prototype._textures=null,i.prototype._alpha=1,i.prototype.render=function(t){if(this._visible){r.node++;var e=this.matrix();t.setTransform(e.a,e.b,e.c,e.d,e.e,e.f),this._alpha=this._pin._alpha*(this._parent?this._parent._alpha:1);var n=this._pin._textureAlpha*this._alpha;if(t.globalAlpha!=n&&(t.globalAlpha=n),null!==this._textures)for(var i=0,o=this._textures.length;i<o;i++)this._textures[i].draw(t);t.globalAlpha!=this._alpha&&(t.globalAlpha=this._alpha);for(var s,u=this._first;s=u;)u=s._next,s.render(t)}},i.prototype._tickBefore=null,i.prototype._tickAfter=null,i.prototype.MAX_ELAPSE=1/0,i.prototype._tick=function(t,e,n){if(this._visible){t>this.MAX_ELAPSE&&(t=this.MAX_ELAPSE);var i=!1;if(null!==this._tickBefore)for(var o=0;o<this._tickBefore.length;o++){r.tick++,i=!0===this._tickBefore[o].call(this,t,e,n)||i}for(var s,u=this._first;s=u;)u=s._next,s._flag("_tick")&&(i=!0===s._tick(t,e,n)||i);if(null!==this._tickAfter)for(o=0;o<this._tickAfter.length;o++){r.tick++,i=!0===this._tickAfter[o].call(this,t,e,n)||i}return i}},i.prototype.tick=function(t,e){"function"==typeof t&&(e?(null===this._tickBefore&&(this._tickBefore=[]),this._tickBefore.push(t)):(null===this._tickAfter&&(this._tickAfter=[]),this._tickAfter.push(t)),this._flag("_tick",null!==this._tickAfter&&this._tickAfter.length>0||null!==this._tickBefore&&this._tickBefore.length>0))},i.prototype.untick=function(t){var e;"function"==typeof t&&(null!==this._tickBefore&&(e=this._tickBefore.indexOf(t))>=0&&this._tickBefore.splice(e,1),null!==this._tickAfter&&(e=this._tickAfter.indexOf(t))>=0&&this._tickAfter.splice(e,1))},i.prototype.timeout=function(t,e){this.setTimeout(t,e)},i.prototype.setTimeout=function(t,e){function n(i){if(!((e-=i)<0))return!0;this.untick(n),t.call(this)}return this.tick(n),n},i.prototype.clearTimeout=function(t){this.untick(t)}},function(t,e){t.exports={}},function(t,e){t.exports=function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)n.hasOwnProperty(i)&&(t[i]=n[i])}return t}},function(t,e){
/**
 * ! is the definitive JavaScript type testing library
 * 
 * @copyright 2013-2014 Enrico Marino / Jordan Harband
 * @license MIT
 */
var n=Object.prototype,i=n.hasOwnProperty,r=n.toString,o=/^[A-Fa-f0-9]+$/,s=t.exports={};s.a=s.an=s.type=function(t,e){return typeof t===e},s.defined=function(t){return void 0!==t},s.empty=function(t){var e,n=r.call(t);if("[object Array]"===n||"[object Arguments]"===n||"[object String]"===n)return 0===t.length;if("[object Object]"===n){for(e in t)if(i.call(t,e))return!1;return!0}return!t},s.equal=function(t,e){if(t===e)return!0;var n,i=r.call(t);if(i!==r.call(e))return!1;if("[object Object]"===i){for(n in t)if(!s.equal(t[n],e[n])||!(n in e))return!1;for(n in e)if(!s.equal(t[n],e[n])||!(n in t))return!1;return!0}if("[object Array]"===i){if((n=t.length)!==e.length)return!1;for(;--n;)if(!s.equal(t[n],e[n]))return!1;return!0}return"[object Function]"===i?t.prototype===e.prototype:"[object Date]"===i&&t.getTime()===e.getTime()},s.instance=function(t,e){return t instanceof e},s.nil=function(t){return null===t},s.undef=function(t){return void 0===t},s.array=function(t){return"[object Array]"===r.call(t)},s.emptyarray=function(t){return s.array(t)&&0===t.length},s.arraylike=function(t){return!!t&&!s.boolean(t)&&i.call(t,"length")&&isFinite(t.length)&&s.number(t.length)&&t.length>=0},s.boolean=function(t){return"[object Boolean]"===r.call(t)},s.element=function(t){return void 0!==t&&"undefined"!=typeof HTMLElement&&t instanceof HTMLElement&&1===t.nodeType},s.fn=function(t){return"[object Function]"===r.call(t)},s.number=function(t){return"[object Number]"===r.call(t)},s.nan=function(t){return!s.number(t)||t!=t},s.object=function(t){return"[object Object]"===r.call(t)},s.hash=function(t){return s.object(t)&&t.constructor===Object&&!t.nodeType&&!t.setInterval},s.regexp=function(t){return"[object RegExp]"===r.call(t)},s.string=function(t){return"[object String]"===r.call(t)},s.hex=function(t){return s.string(t)&&(!t.length||o.test(t))}},function(t,e,n){var i=n(5),r=n(9);function o(t,e){"object"==typeof t&&this.src(t,e)}o.prototype.pipe=function(){return new o(this)},o.prototype.src=function(t,e,n,i){if("object"==typeof t){var r=t,o=e||1;this._image=r,this._sx=this._dx=0,this._sy=this._dy=0,this._sw=this._dw=r.width/o,this._sh=this._dh=r.height/o,this.width=r.width/o,this.height=r.height/o,this.ratio=o}else void 0===n?(n=t,i=e):(this._sx=t,this._sy=e),this._sw=this._dw=n,this._sh=this._dh=i,this.width=n,this.height=i;return this},o.prototype.dest=function(t,e,n,i){return this._dx=t,this._dy=e,this._dx=t,this._dy=e,void 0!==n&&(this._dw=n,this._dh=i,this.width=n,this.height=i),this},o.prototype.draw=function(t,e,n,o,s,u,a,c,h){var f=this._image;if(null!==f&&"object"==typeof f){var l=this._sx,p=this._sy,y=this._sw,_=this._sh,d=this._dx,v=this._dy,g=this._dw,m=this._dh;void 0!==u?(e=r.limit(e,0,this._sw),o=r.limit(o,0,this._sw-e),l+=e,p+=n=r.limit(n,0,this._sh),y=o,_=s=r.limit(s,0,this._sh-n),d=u,v=a,g=c,m=h):void 0!==o?(d=e,v=n,g=o,m=s):void 0!==e&&(g=e,m=n);var b=this.ratio||1;l*=b,p*=b,y*=b,_*=b;try{"function"==typeof f.draw?f.draw(t,l,p,y,_,d,v,g,m):(i.draw++,t.drawImage(f,l,p,y,_,d,v,g,m))}catch(t){f._draw_failed||(console.log("Unable to draw: ",f),console.log(t),f._draw_failed=!0)}}},t.exports=o},function(t,e,n){var i=n(2),r=Math;t.exports=i(Math),t.exports.random=function(t,e){return void 0===t?(e=1,t=0):void 0===e&&(e=t,t=0),t==e?t:r.random()*(e-t)+t},t.exports.rotate=function(t,e,n){return void 0===e?(n=1,e=0):void 0===n&&(n=e,e=0),n>e?(t=(t-e)%(n-e))+(t<0?n:e):(t=(t-n)%(e-n))+(t<=0?e:n)},t.exports.limit=function(t,e,n){return t<e?e:t>n?n:t},t.exports.length=function(t,e){return r.sqrt(t*t+e*e)}},function(t,e){function n(t,e,n,i,r,o){this.reset(t,e,n,i,r,o)}n.prototype.toString=function(){return"["+this.a+", "+this.b+", "+this.c+", "+this.d+", "+this.e+", "+this.f+"]"},n.prototype.clone=function(){return new n(this.a,this.b,this.c,this.d,this.e,this.f)},n.prototype.reset=function(t,e,n,i,r,o){return this._dirty=!0,"object"==typeof t?(this.a=t.a,this.d=t.d,this.b=t.b,this.c=t.c,this.e=t.e,this.f=t.f):(this.a=t||1,this.d=i||1,this.b=e||0,this.c=n||0,this.e=r||0,this.f=o||0),this},n.prototype.identity=function(){return this._dirty=!0,this.a=1,this.b=0,this.c=0,this.d=1,this.e=0,this.f=0,this},n.prototype.rotate=function(t){if(!t)return this;this._dirty=!0;var e=t?Math.cos(t):1,n=t?Math.sin(t):0,i=e*this.a-n*this.b,r=e*this.b+n*this.a,o=e*this.c-n*this.d,s=e*this.d+n*this.c,u=e*this.e-n*this.f,a=e*this.f+n*this.e;return this.a=i,this.b=r,this.c=o,this.d=s,this.e=u,this.f=a,this},n.prototype.translate=function(t,e){return t||e?(this._dirty=!0,this.e+=t,this.f+=e,this):this},n.prototype.scale=function(t,e){return t-1||e-1?(this._dirty=!0,this.a*=t,this.b*=e,this.c*=t,this.d*=e,this.e*=t,this.f*=e,this):this},n.prototype.skew=function(t,e){if(!t&&!e)return this;this._dirty=!0;var n=this.a+this.b*t,i=this.b+this.a*e,r=this.c+this.d*t,o=this.d+this.c*e,s=this.e+this.f*t,u=this.f+this.e*e;return this.a=n,this.b=i,this.c=r,this.d=o,this.e=s,this.f=u,this},n.prototype.concat=function(t){this._dirty=!0;var e=this,n=e.a*t.a+e.b*t.c,i=e.b*t.d+e.a*t.b,r=e.c*t.a+e.d*t.c,o=e.d*t.d+e.c*t.b,s=e.e*t.a+t.e+e.f*t.c,u=e.f*t.d+t.f+e.e*t.b;return this.a=n,this.b=i,this.c=r,this.d=o,this.e=s,this.f=u,this},n.prototype.inverse=n.prototype.reverse=function(){if(this._dirty){this._dirty=!1,this.inversed=this.inversed||new n;var t=this.a*this.d-this.b*this.c;this.inversed.a=this.d/t,this.inversed.b=-this.b/t,this.inversed.c=-this.c/t,this.inversed.d=this.a/t,this.inversed.e=(this.c*this.f-this.e*this.d)/t,this.inversed.f=(this.e*this.b-this.a*this.f)/t}return this.inversed},n.prototype.map=function(t,e){return(e=e||{}).x=this.a*t.x+this.c*t.y+this.e,e.y=this.b*t.x+this.d*t.y+this.f,e},n.prototype.mapX=function(t,e){return"object"==typeof t&&(e=t.y,t=t.x),this.a*t+this.c*e+this.e},n.prototype.mapY=function(t,e){return"object"==typeof t&&(e=t.y,t=t.x),this.b*t+this.d*e+this.f},t.exports=n},function(t,e,n){t.exports=n(1),t.exports.Matrix=n(10),t.exports.Texture=n(8),n(13),n(15),n(16),n(3),n(4),n(18)},function(t,e){t.exports=function(){var t=0;function e(e,n){return t+=n="number"==typeof n&&n>=1?n:1,function(){e&&e.apply(this,arguments),n>0&&(n--,t--,i())}}var n=[];function i(){if(0===t)for(;n.length;)setTimeout(n.shift(),0)}return e.then=function(e){0===t?setTimeout(e,0):n.push(e)},e}},function(t,e,n){"undefined"==typeof DEBUG&&(DEBUG=!0);var i=n(1),r=n(8),o=n(6),s=n(2),u=n(7),a=n(14),c={},h=[];function f(t){f._super.call(this);var e=this;_(t,"filter"),_(t,"cutouts"),_(t,"sprites"),_(t,"factory");var n=t.map||t.filter,i=t.ppu||t.ratio||1,r=t.trim||0,s=t.textures,c=t.factory,h=t.cutouts||t.sprites;function l(t){if(!t||u.fn(t.draw))return t;t=o({},t),u.fn(n)&&(t=n(t)),1!=i&&(t.x*=i,t.y*=i,t.width*=i,t.height*=i,t.top*=i,t.bottom*=i,t.left*=i,t.right*=i),0!=r&&(t.x+=r,t.y+=r,t.width-=2*r,t.height-=2*r,t.top-=r,t.bottom-=r,t.left-=r,t.right-=r);var s=e.pipe();return s.top=t.top,s.bottom=t.bottom,s.left=t.left,s.right=t.right,s.src(t.x,t.y,t.width,t.height),s}function p(t){if(s){if(u.fn(s))return s(t);if(u.hash(s))return s[t]}if(h){for(var e=null,n=0,i=0;i<h.length;i++)a.startsWith(h[i].name,t)&&(0===n?e=h[i]:1===n?e=[e,h[i]]:e.push(h[i]),n++);return 0===n&&u.fn(c)&&(e=function(e){return c(t+(e||""))}),e}}this.select=function(t){if(!t)return new y(this.pipe());var e=p(t);return e?new y(e,p,l):void 0}}i.atlas=function(t){var e=u.fn(t.draw)?t:new f(t);t.name&&(c[t.name]=e),h.push(e),_(t,"imagePath"),_(t,"imageRatio");var n=t.imagePath,r=t.imageRatio||1;return u.string(t.image)?n=t.image:u.hash(t.image)&&(n=t.image.src||t.image.url,r=t.image.ratio||r),n&&i.preload((function(t){n=i.resolve(n),DEBUG&&console.log("Loading atlas: "+n),i.config("image-loader")(n,(function(i){DEBUG&&console.log("Image loaded: "+n),e.src(i,r),t()}),(function(e){DEBUG&&console.log("Error loading atlas: "+n,e),t()}))})),e},f._super=r,f.prototype=s(f._super.prototype);var l=new r;l.x=l.y=l.width=l.height=0,l.pipe=l.src=l.dest=function(){return this},l.draw=function(){};var p=new y(l);function y(t,e,n){function i(t,r){return t?u.fn(t.draw)?t:u.hash(t)&&u.number(t.width)&&u.number(t.height)&&u.fn(n)?n(t):u.hash(t)&&u.defined(r)?i(t[r]):u.fn(t)?i(t(r)):u.array(t)?i(t[0]):u.string(t)&&u.fn(e)?i(e(t)):void 0:l}this.one=function(e){return i(t,e)},this.array=function(e){var n=u.array(e)?e:[];if(u.array(t))for(var r=0;r<t.length;r++)n[r]=i(t[r]);else n[0]=i(t);return n}}function _(t,e,n){e in t&&console.log(n?n.replace("%name",e):"'"+e+"' field of texture atlas is deprecated.")}i.texture=function(t){if(!u.string(t))return new y(t);var e,n,i=null;for((n=t.indexOf(":"))>0&&t.length>n+1&&(i=(e=c[t.slice(0,n)])&&e.select(t.slice(n+1))),!i&&(e=c[t])&&(i=e.select()),n=0;!i&&n<h.length;n++)i=h[n].select(t);return i||(console.error("Texture not found: "+t),i=p),i},t.exports=f},function(t,e){t.exports.startsWith=function(t,e){return"string"==typeof t&&"string"==typeof e&&t.substring(0,e.length)==e}},function(t,e,n){var i=n(1),r=n(7),o=0;function s(t,e){h(e),h(t),e.remove(),t._last&&(t._last._next=e,e._prev=t._last),e._parent=t,t._last=e,t._first||(t._first=e),e._parent._flag(e,!0),e._ts_parent=++o,t._ts_children=++o,t.touch()}function u(t,e){h(e),h(t),e.remove(),t._first&&(t._first._prev=e,e._next=t._first),e._parent=t,t._first=e,t._last||(t._last=e),e._parent._flag(e,!0),e._ts_parent=++o,t._ts_children=++o,t.touch()}function a(t,e){h(t),h(e),t.remove();var n=e._parent,i=e._prev;e._prev=t,i&&(i._next=t)||n&&(n._first=t),t._parent=n,t._prev=i,t._next=e,t._parent._flag(t,!0),t._ts_parent=++o,t.touch()}function c(t,e){h(t),h(e),t.remove();var n=e._parent,i=e._next;e._next=t,i&&(i._prev=t)||n&&(n._last=t),t._parent=n,t._prev=e,t._next=i,t._parent._flag(t,!0),t._ts_parent=++o,t.touch()}function h(t){if(t&&t instanceof i)return t;throw"Invalid node: "+t}i.prototype._label="",i.prototype._visible=!0,i.prototype._parent=null,i.prototype._next=null,i.prototype._prev=null,i.prototype._first=null,i.prototype._last=null,i.prototype._attrs=null,i.prototype._flags=null,i.prototype.toString=function(){return"["+this._label+"]"},i.prototype.id=function(t){return this.label(t)},i.prototype.label=function(t){return void 0===t?this._label:(this._label=t,this)},i.prototype.attr=function(t,e){return void 0===e?null!==this._attrs?this._attrs[t]:void 0:((null!==this._attrs?this._attrs:this._attrs={})[t]=e,this)},i.prototype.visible=function(t){return void 0===t?this._visible:(this._visible=t,this._parent&&(this._parent._ts_children=++o),this._ts_pin=++o,this.touch(),this)},i.prototype.hide=function(){return this.visible(!1)},i.prototype.show=function(){return this.visible(!0)},i.prototype.parent=function(){return this._parent},i.prototype.next=function(t){for(var e=this._next;e&&t&&!e._visible;)e=e._next;return e},i.prototype.prev=function(t){for(var e=this._prev;e&&t&&!e._visible;)e=e._prev;return e},i.prototype.first=function(t){for(var e=this._first;e&&t&&!e._visible;)e=e._next;return e},i.prototype.last=function(t){for(var e=this._last;e&&t&&!e._visible;)e=e._prev;return e},i.prototype.visit=function(t,e){var n=t.reverse,i=t.visible;if(!t.start||!t.start(this,e)){for(var r,o=n?this.last(i):this.first(i);r=o;)if(o=n?r.prev(i):r.next(i),r.visit(t,e))return!0;return t.end&&t.end(this,e)}},i.prototype.append=function(t,e){if(r.array(t))for(var n=0;n<t.length;n++)s(this,t[n]);else if(void 0!==e)for(n=0;n<arguments.length;n++)s(this,arguments[n]);else void 0!==t&&s(this,t);return this},i.prototype.prepend=function(t,e){if(r.array(t))for(var n=t.length-1;n>=0;n--)u(this,t[n]);else if(void 0!==e)for(n=arguments.length-1;n>=0;n--)u(this,arguments[n]);else void 0!==t&&u(this,t);return this},i.prototype.appendTo=function(t){return s(t,this),this},i.prototype.prependTo=function(t){return u(t,this),this},i.prototype.insertNext=function(t,e){if(r.array(t))for(var n=0;n<t.length;n++)c(t[n],this);else if(void 0!==e)for(n=0;n<arguments.length;n++)c(arguments[n],this);else void 0!==t&&c(t,this);return this},i.prototype.insertPrev=function(t,e){if(r.array(t))for(var n=t.length-1;n>=0;n--)a(t[n],this);else if(void 0!==e)for(n=arguments.length-1;n>=0;n--)a(arguments[n],this);else void 0!==t&&a(t,this);return this},i.prototype.insertAfter=function(t){return c(this,t),this},i.prototype.insertBefore=function(t){return a(this,t),this},i.prototype.remove=function(t,e){if(void 0!==t){if(r.array(t))for(var n=0;n<t.length;n++)h(t[n]).remove();else if(void 0!==e)for(n=0;n<arguments.length;n++)h(arguments[n]).remove();else h(t).remove();return this}return this._prev&&(this._prev._next=this._next),this._next&&(this._next._prev=this._prev),this._parent&&(this._parent._first===this&&(this._parent._first=this._next),this._parent._last===this&&(this._parent._last=this._prev),this._parent._flag(this,!1),this._parent._ts_children=++o,this._parent.touch()),this._prev=this._next=this._parent=null,this._ts_parent=++o,this},i.prototype.empty=function(){for(var t,e=this._first;t=e;)e=t._next,t._prev=t._next=t._parent=null,this._flag(t,!1);return this._first=this._last=null,this._ts_children=++o,this.touch(),this},i.prototype.touch=function(){return this._ts_touch=++o,this._parent&&this._parent.touch(),this},i.prototype._flag=function(t,e){if(void 0===e)return null!==this._flags&&this._flags[t]||0;if("string"==typeof t&&(e?(this._flags=this._flags||{},!this._flags[t]&&this._parent&&this._parent._flag(t,!0),this._flags[t]=(this._flags[t]||0)+1):this._flags&&this._flags[t]>0&&(1==this._flags[t]&&this._parent&&this._parent._flag(t,!1),this._flags[t]=this._flags[t]-1)),"object"==typeof t&&t._flags)for(var n in t._flags)t._flags[n]>0&&this._flag(n,e);return this},i.prototype.hitTest=function(t){return!!this.attr("spy")||t.x>=0&&t.x<=this._pin._width&&t.y>=0&&t.y<=this._pin._height},t.exports=i},function(t,e,n){n(17)(n(1).prototype,(function(t,e,n){t._flag(e,n)}))},function(t,e){t.exports=function(t,e){t._listeners=null,t.on=t.listen=function(t,n){if(!t||!t.length||"function"!=typeof n)return this;if(null===this._listeners&&(this._listeners={}),t=("string"!=typeof t&&"function"==typeof t.join?t.join(" "):t).match(/\S+/g))for(var i=0;i<t.length;i++){var r=t[i];this._listeners[r]=this._listeners[r]||[],this._listeners[r].push(n),"function"==typeof e&&e(this,r,!0)}return this},t.off=function(t,n){if(!t||!t.length||"function"!=typeof n)return this;if(null===this._listeners)return this;if(t=("string"!=typeof t&&"function"==typeof t.join?t.join(" "):t).match(/\S+/g))for(var i=0;i<t.length;i++){var r,o=t[i],s=this._listeners[o];s&&(r=s.indexOf(n))>=0&&(s.splice(r,1),s.length||delete this._listeners[o],"function"==typeof e&&e(this,o,!1))}return this},t.listeners=function(t){return this._listeners&&this._listeners[t]},t.publish=function(t,e){var n=this.listeners(t);if(!n||!n.length)return 0;for(var i=0;i<n.length;i++)n[i].apply(this,e);return n.length},t.trigger=function(t,e){return this.publish(t,e),this}}},function(t,e,n){var i=n(1);n(3),n(4);var r=n(5),o=n(2),s=n(6);function u(t,e){u._super.call(this),this.label("Root");var n=!0,i=this,o=0,s=function(u){if(!0!==n){r.tick=r.node=r.draw=0;var a=o||u,c=u-a;o=u;var h=i._tick(c,u,a);i._mo_touch!=i._ts_touch?(i._mo_touch=i._ts_touch,e(i),t(s)):h?t(s):n=!0,r.fps=c?1e3/c:0}};this.start=function(){return this.resume()},this.resume=function(){return n&&(this.publish("resume"),n=!1,t(s)),this},this.pause=function(){return n||this.publish("pause"),n=!0,this},this.touch_root=this.touch,this.touch=function(){return this.resume(),this.touch_root()}}u._super=i,u.prototype=o(u._super.prototype),i.root=function(t,e){return new u(t,e)},u.prototype.background=function(t){return this},u.prototype.viewport=function(t,e,n){if(void 0===t)return s({},this._viewport);this._viewport={width:t,height:e,ratio:n||1},this.viewbox();var i=s({},this._viewport);return this.visit({start:function(t){if(!t._flag("viewport"))return!0;t.publish("viewport",[i])}}),this},u.prototype.viewbox=function(t,e,n){"number"==typeof t&&"number"==typeof e&&(this._viewbox={width:t,height:e,mode:/^(in|out|in-pad|out-crop)$/.test(n)?n:"in-pad"});var i=this._viewbox,r=this._viewport;return r&&i?(this.pin({width:i.width,height:i.height}),this.scaleTo(r.width,r.height,i.mode)):r&&this.pin({width:r.width,height:r.height}),this}},function(t,e,n){var i=n(1),r=n(8);i.canvas=function(t,e,n){"string"==typeof t?"object"==typeof e||("function"==typeof e&&(n=e),e={}):("function"==typeof t&&(n=t),e={},t="2d");var i=document.createElement("canvas"),o=i.getContext(t,e),s=new r(i);return s.context=function(){return o},s.size=function(t,e,n){return n=n||1,i.width=t*n,i.height=e*n,this.src(i,n),this},s.canvas=function(t){return"function"==typeof t?t.call(this,o):void 0===t&&"function"==typeof n&&n.call(this,o),this},"function"==typeof n&&n.call(s,o),s}},function(t,e,n){var i=n(1);n(3),n(4);var r=n(21),o=n(2);function s(){s._super.call(this),this.label("Image"),this._textures=[],this._image=null}t.exports=s,i.image=function(t){var e=new s;return t&&e.image(t),e},s._super=i,s.prototype=o(s._super.prototype),s.prototype.setImage=function(t,e,n){return this.image(t,e,n)},s.prototype.image=function(t){return this._image=i.texture(t).one(),this.pin("width",this._image?this._image.width:0),this.pin("height",this._image?this._image.height:0),this._textures[0]=this._image.pipe(),this._textures.length=1,this},s.prototype.tile=function(t){return this._repeat(!1,t),this},s.prototype.stretch=function(t){return this._repeat(!0,t),this},s.prototype._repeat=function(t,e){var n=this;function i(t,e,i,r,o,s,u,a,c){var h=n._textures.length>t?n._textures[t]:n._textures[t]=n._image.pipe();h.src(e,i,r,o),h.dest(s,u,a,c)}this.untick(this._repeatTicker),this.tick(this._repeatTicker=function(){if(this._mo_stretch!=this._pin._ts_transform){this._mo_stretch=this._pin._ts_transform;var n=this.pin("width"),o=this.pin("height");this._textures.length=r(this._image,n,o,t,e,i)}})}},function(t,e){t.exports=function(t,e,n,i,r,o){var s=t.width,u=t.height,a=t.left,c=t.right,h=t.top,f=t.bottom;s=s-(a="number"==typeof a&&a==a?a:0)-(c="number"==typeof c&&c==c?c:0),u=u-(h="number"==typeof h&&h==h?h:0)-(f="number"==typeof f&&f==f?f:0),r||(e=Math.max(e-a-c,0),n=Math.max(n-h-f,0));var l=0;if(h>0&&a>0&&o(l++,0,0,a,h,0,0,a,h),f>0&&a>0&&o(l++,0,u+h,a,f,0,n+h,a,f),h>0&&c>0&&o(l++,s+a,0,c,h,e+a,0,c,h),f>0&&c>0&&o(l++,s+a,u+h,c,f,e+a,n+h,c,f),i)h>0&&o(l++,a,0,s,h,a,0,e,h),f>0&&o(l++,a,u+h,s,f,a,n+h,e,f),a>0&&o(l++,0,h,a,u,0,h,a,n),c>0&&o(l++,s+a,h,c,u,e+a,h,c,n),o(l++,a,h,s,u,a,h,e,n);else for(var p,y=a,_=e;_>0;){p=Math.min(s,_),_-=s;for(var d,v=h,g=n;g>0;)d=Math.min(u,g),g-=u,o(l++,a,h,p,d,y,v,p,d),_<=0&&(a&&o(l++,0,h,a,d,0,v,a,d),c&&o(l++,s+a,h,c,d,y+p,v,c,d)),v+=d;h&&o(l++,a,0,p,h,y,0,p,h),f&&o(l++,a,u+h,p,f,y,v,p,f),y+=p}return l}},function(t,e,n){var i=n(1);n(3),n(4);var r=n(2),o=n(9);function s(){s._super.call(this),this.label("Anim"),this._textures=[],this._fps=i.Anim.FPS,this._ft=1e3/this._fps,this._time=-1,this._repeat=0,this._index=0,this._frames=[];var t=0;this.tick((function(e,n,i){if(!(this._time<0||this._frames.length<=1)){var r=t!=i;if(t=n,r)return!0;if(this._time+=e,this._time<this._ft)return!0;var o=this._time/this._ft|0;return this._time-=o*this._ft,this.moveFrame(o),!(this._repeat>0&&(this._repeat-=o)<=0)||(this.stop(),this._callback&&this._callback(),!1)}}),!1)}i.anim=function(t,e){var n=new s;return n.frames(t).gotoFrame(0),e&&n.fps(e),n},s._super=i,s.prototype=r(s._super.prototype),i.Anim={FPS:15},s.prototype.fps=function(t){return void 0===t?this._fps:(this._fps=t>0?t:i.Anim.FPS,this._ft=1e3/this._fps,this)},s.prototype.setFrames=function(t,e,n){return this.frames(t,e,n)},s.prototype.frames=function(t){return this._index=0,this._frames=i.texture(t).array(),this.touch(),this},s.prototype.length=function(){return this._frames?this._frames.length:0},s.prototype.gotoFrame=function(t,e){return this._index=0|o.rotate(t,this._frames.length),e=e||!this._textures[0],this._textures[0]=this._frames[this._index],e&&(this.pin("width",this._textures[0].width),this.pin("height",this._textures[0].height)),this.touch(),this},s.prototype.moveFrame=function(t){return this.gotoFrame(this._index+t)},s.prototype.repeat=function(t,e){return this._repeat=t*this._frames.length-1,this._callback=e,this.play(),this},s.prototype.play=function(t){return void 0!==t?(this.gotoFrame(t),this._time=0):this._time<0&&(this._time=0),this.touch(),this},s.prototype.stop=function(t){return this._time=-1,void 0!==t&&this.gotoFrame(t),this}},function(t,e,n){var i=n(1);n(3),n(4);var r=n(2),o=n(7);function s(){s._super.call(this),this.label("String"),this._textures=[]}i.string=function(t){return(new s).frames(t)},s._super=i,s.prototype=r(s._super.prototype),s.prototype.setFont=function(t,e,n){return this.frames(t,e,n)},s.prototype.frames=function(t){return this._textures=[],"string"==typeof t?(t=i.texture(t),this._item=function(e){return t.one(e)}):"object"==typeof t?this._item=function(e){return t[e]}:"function"==typeof t&&(this._item=t),this},s.prototype.setValue=function(t,e,n){return this.value(t,e,n)},s.prototype.value=function(t){if(void 0===t)return this._value;if(this._value===t)return this;this._value=t,null===t?t="":"string"==typeof t||o.array(t)||(t=t.toString()),this._spacing=this._spacing||0;for(var e=0,n=0,i=0;i<t.length;i++){var r=this._textures[i]=this._item(t[i]);e+=i>0?this._spacing:0,r.dest(e,0),e+=r.width,n=Math.max(n,r.height)}return this.pin("width",e),this.pin("height",n),this._textures.length=t.length,this}},function(t,e,n){var i=n(1);n(3),n(4);n(2);i.row=function(t){return i.create().row(t).label("Row")},i.prototype.row=function(t){return this.sequence("row",t),this},i.column=function(t){return i.create().column(t).label("Row")},i.prototype.column=function(t){return this.sequence("column",t),this},i.sequence=function(t,e){return i.create().sequence(t,e).label("Sequence")},i.prototype.sequence=function(t,e){return this._padding=this._padding||0,this._spacing=this._spacing||0,this.untick(this._layoutTiker),this.tick(this._layoutTiker=function(){if(this._mo_seq!=this._ts_touch){this._mo_seq=this._ts_touch;var n=this._mo_seqAlign!=this._ts_children;this._mo_seqAlign=this._ts_children;for(var i,r=0,o=0,s=this.first(!0),u=!0;i=s;){s=i.next(!0),i.matrix(!0);var a=i.pin("boxWidth"),c=i.pin("boxHeight");"column"==t?(!u&&(o+=this._spacing),i.pin("offsetY")!=o&&i.pin("offsetY",o),r=Math.max(r,a),o+=c,n&&i.pin("alignX",e)):"row"==t&&(!u&&(r+=this._spacing),i.pin("offsetX")!=r&&i.pin("offsetX",r),r+=a,o=Math.max(o,c),n&&i.pin("alignY",e)),u=!1}r+=2*this._padding,o+=2*this._padding,this.pin("width")!=r&&this.pin("width",r),this.pin("height")!=o&&this.pin("height",o)}}),this},i.box=function(){return i.create().box().label("Box")},i.prototype.box=function(){return this._padding=this._padding||0,this.untick(this._layoutTiker),this.tick(this._layoutTiker=function(){if(this._mo_box!=this._ts_touch){this._mo_box=this._ts_touch;for(var t,e=0,n=0,i=this.first(!0);t=i;){i=t.next(!0),t.matrix(!0);var r=t.pin("boxWidth"),o=t.pin("boxHeight");e=Math.max(e,r),n=Math.max(n,o)}e+=2*this._padding,n+=2*this._padding,this.pin("width")!=e&&this.pin("width",e),this.pin("height")!=n&&this.pin("height",n)}}),this},i.layer=function(){return i.create().layer().label("Layer")},i.prototype.layer=function(){return this.untick(this._layoutTiker),this.tick(this._layoutTiker=function(){var t=this.parent();if(t){var e=t.pin("width");this.pin("width")!=e&&this.pin("width",e);var n=t.pin("height");this.pin("height")!=n&&this.pin("height",n)}},!0),this},i.prototype.padding=function(t){return this._padding=t,this},i.prototype.spacing=function(t){return this._spacing=t,this}},function(t,e,n){var i=n(26),r=n(1),o=n(3);function s(t,e,n){this._end={},this._duration=e||400,this._delay=n||0,this._owner=t,this._time=0}function u(t,e,n,i){"number"==typeof t.pin(n)?e[n]=i:"number"==typeof t.pin(n+"X")&&"number"==typeof t.pin(n+"Y")&&(e[n+"X"]=i,e[n+"Y"]=i)}r.prototype.tween=function(t,e,n){if("number"!=typeof t?(n=t,e=0,t=0):"number"!=typeof e&&(n=e,e=0),!this._tweens){this._tweens=[];var i=0;this.tick((function(t,e,n){if(this._tweens.length){var r=i!=n;if(i=e,r)return!0;var o=this._tweens[0],s=o.tick(this,t,e,n);if(s&&o===this._tweens[0]&&this._tweens.shift(),"function"==typeof s)try{s.call(this)}catch(t){console.log(t)}return"object"==typeof s&&this._tweens.unshift(s),!0}}),!0)}this.touch(),n||(this._tweens.length=0);var r=new s(this,t,e);return this._tweens.push(r),r},s.prototype.tick=function(t,e,n,i){if(this._time+=e,!(this._time<this._delay)){var r,o,s=this._time-this._delay;if(!this._start)for(var u in this._start={},this._end)this._start[u]=this._owner.pin(u);s<this._duration?(r=s/this._duration,o=!1):(r=1,o=!0),"function"==typeof this._easing&&(r=this._easing(r));var a=1-r;for(var u in this._end)this._owner.pin(u,this._start[u]*a+this._end[u]*r);return o?this._next||this._done||!0:void 0}},s.prototype.tween=function(t,e){return this._next=new s(this._owner,t,e)},s.prototype.duration=function(t){return this._duration=t,this},s.prototype.delay=function(t){return this._delay=t,this},s.prototype.ease=function(t){return this._easing=i(t),this},s.prototype.done=function(t){return this._done=t,this},s.prototype.hide=function(){return this.done((function(){this.hide()})),this},s.prototype.remove=function(){return this.done((function(){this.remove()})),this},s.prototype.pin=function(t,e){if("object"==typeof t)for(var n in t)u(this._owner,this._end,n,t[n]);else void 0!==e&&u(this._owner,this._end,t,e);return this},o._add_shortcuts(s),s.prototype.then=function(t){return this.done(t),this},s.prototype.clear=function(t){return this},t.exports=s},function(t,e){function n(t){return t}var i={},r={},o={};function s(t){if("function"==typeof t)return t;if("string"!=typeof t)return n;var e=i[t];if(e)return e;var s=/^(\w+)(-(in|out|in-out|out-in))?(\((.*)\))?$/i.exec(t);if(!s||!s.length)return n;var u=o[s[1]],a=r[s[3]],c=s[5];return e=u&&u.fn?u.fn:u&&u.fc?u.fc.apply(u.fc,c&&c.replace(/\s+/,"").split(",")):n,a&&(e=a.fn(e)),i[t]=e,e}s.add=function(t){for(var e=(t.name||t.mode).split(/\s+/),n=0;n<e.length;n++){var i=e[n];i&&((t.name?o:r)[i]=t)}},s.add({mode:"in",fn:function(t){return t}}),s.add({mode:"out",fn:function(t){return function(e){return 1-t(1-e)}}}),s.add({mode:"in-out",fn:function(t){return function(e){return e<.5?t(2*e)/2:1-t(2*(1-e))/2}}}),s.add({mode:"out-in",fn:function(t){return function(e){return e<.5?1-t(2*(1-e))/2:t(2*e)/2}}}),s.add({name:"linear",fn:function(t){return t}}),s.add({name:"quad",fn:function(t){return t*t}}),s.add({name:"cubic",fn:function(t){return t*t*t}}),s.add({name:"quart",fn:function(t){return t*t*t*t}}),s.add({name:"quint",fn:function(t){return t*t*t*t*t}}),s.add({name:"sin sine",fn:function(t){return 1-Math.cos(t*Math.PI/2)}}),s.add({name:"exp expo",fn:function(t){return 0==t?0:Math.pow(2,10*(t-1))}}),s.add({name:"circle circ",fn:function(t){return 1-Math.sqrt(1-t*t)}}),s.add({name:"bounce",fn:function(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375}}),s.add({name:"poly",fc:function(t){return function(e){return Math.pow(e,t)}}}),s.add({name:"elastic",fc:function(t,e){t=t||1;var n=(e=e||.45)/(2*Math.PI)*Math.asin(1/t);return function(i){return 1+t*Math.pow(2,-10*i)*Math.sin((i-n)*(2*Math.PI)/e)}}}),s.add({name:"back",fc:function(t){return t=void 0!==t?t:1.70158,function(e){return e*e*((t+1)*e-t)}}}),t.exports=s},function(t,e,n){function i(t,e){if(this instanceof i){var n=t.viewport().ratio||1;t.on("viewport",(function(t){n=t.ratio||n})),this.x=0,this.y=0,this.toString=function(){return(0|this.x)+"x"+(0|this.y)},this.locate=function(t){!function(t,e,n){e.touches&&e.touches.length?(n.x=e.touches[0].clientX,n.y=e.touches[0].clientY):(n.x=e.clientX,n.y=e.clientY);var i=t.getBoundingClientRect();n.x-=i.left,n.y-=i.top,n.x-=0|t.clientLeft,n.y-=0|t.clientTop}(e,t,this),this.x*=n,this.y*=n},this.lookup=function(e,n){this.type=e,this.root=t,this.event=null,n.length=0,this.collect=n,this.root.visit(this.visitor,this)},this.publish=function(e,n,i){if(this.type=e,this.root=t,this.event=n,this.collect=!1,this.timeStamp=Date.now(),"mousemove"!==e&&"touchmove"!==e&&DEBUG&&console.log(this.type+" "+this),i){for(;i.length&&!this.visitor.end(i.shift(),this););i.length=0}else this.root.visit(this.visitor,this)},this.visitor={reverse:!0,visible:!0,start:function(t,e){return!t._flag(e.type)},end:function(t,e){r.raw=e.event,r.type=e.type,r.timeStamp=e.timeStamp,r.abs.x=e.x,r.abs.y=e.y;var n=t.listeners(e.type);if(n&&(t.matrix().inverse().map(e,r),(t===e.root||t.hitTest(r))&&(e.collect&&e.collect.push(t),e.event))){for(var i=!1,o=0;o<n.length;o++)i=!!n[o].call(t,r)||i;return i}}}}}"undefined"==typeof DEBUG&&(DEBUG=!0),n(1)._load((function(t,e){i.subscribe(t,e)})),i.CLICK="click",i.START="touchstart mousedown",i.MOVE="touchmove mousemove",i.END="touchend mouseup",i.CANCEL="touchcancel mousecancel",i.subscribe=function(t,e){if(!t.mouse){t.mouse=new i(t,e),e.addEventListener("touchstart",o),e.addEventListener("touchend",u),e.addEventListener("touchmove",s),e.addEventListener("touchcancel",a),e.addEventListener("mousedown",o),e.addEventListener("mouseup",u),e.addEventListener("mousemove",s),document.addEventListener("mouseup",a),window.addEventListener("blur",a);var n=[],r=[]}function o(e){e.preventDefault(),t.mouse.locate(e),t.mouse.publish(e.type,e),t.mouse.lookup("click",n),t.mouse.lookup("mousecancel",r)}function s(e){e.preventDefault(),t.mouse.locate(e),t.mouse.publish(e.type,e)}function u(e){e.preventDefault(),t.mouse.publish(e.type,e),n.length&&t.mouse.publish("click",e,n),r.length=0}function a(e){r.length&&t.mouse.publish("mousecancel",e,r),n.length=0}};var r={},o={};function s(t,e,n){Object.defineProperty(t,e,{value:n})}s(r,"clone",(function(t){return(t=t||{}).x=this.x,t.y=this.y,t})),s(r,"toString",(function(){return(0|this.x)+"x"+(0|this.y)+" ("+this.abs+")"})),s(r,"abs",o),s(o,"clone",(function(t){return(t=t||{}).x=this.x,t.y=this.y,t})),s(o,"toString",(function(){return(0|this.x)+"x"+(0|this.y)})),t.exports=i},function(t,e,n){"undefined"==typeof DEBUG&&(DEBUG=!0);var i,r=n(1);r._supported=!(!(i=document.createElement("canvas")).getContext||!i.getContext("2d")),window.addEventListener("load",(function(){DEBUG&&console.log("On load."),r._supported&&r.start()}),!1),r.config({"app-loader":function(t,e){var n,i=(e=e||{}).canvas,o=null,s=!1,u=0,a=0;"string"==typeof i&&(i=document.getElementById(i));i||(i=document.getElementById("cutjs")||document.getElementById("stage"));if(!i){s=!0,DEBUG&&console.log("Creating Canvas..."),(i=document.createElement("canvas")).style.position="absolute",i.style.top="0",i.style.left="0";var c=document.body;c.insertBefore(i,c.firstChild)}o=i.getContext("2d");var h=window.devicePixelRatio||1,f=o.webkitBackingStorePixelRatio||o.mozBackingStorePixelRatio||o.msBackingStorePixelRatio||o.oBackingStorePixelRatio||o.backingStorePixelRatio||1;n=h/f;var l=window.requestAnimationFrame||window.msRequestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.oRequestAnimationFrame||function(t){return window.setTimeout(t,1e3/60)};DEBUG&&console.log("Creating stage...");var p=r.root(l,y);function y(){o.setTransform(1,0,0,1,0,0),o.clearRect(0,0,u,a),p.render(o)}function _(){s?(u=window.innerWidth>0?window.innerWidth:screen.width,a=window.innerHeight>0?window.innerHeight:screen.height,i.style.width=u+"px",i.style.height=a+"px"):(u=i.clientWidth,a=i.clientHeight),u*=n,a*=n,i.width===u&&i.height===a||(i.width=u,i.height=a,DEBUG&&console.log("Resize: "+u+" x "+a+" / "+n),p.viewport(u,a,n),y())}p.background=function(t){return i.style.backgroundColor=t,this},t(p,i),_(),window.addEventListener("resize",_,!1),window.addEventListener("orientationchange",_,!1)},"image-loader":function(t,e,n){DEBUG&&console.log("Loading image: "+t);var i=new Image;i.onload=function(){e(i)},i.onerror=n,i.src=t}})},function(t,e,n){"use strict";n.r(e);var i=n(0),r=n.n(i),o=[{image:"static/shuttle.png",textures:{shuttle:{x:0,y:0,width:52,height:52}}},{image:"static/laser-blue.png",textures:{bullet:{x:0,y:0,width:15,height:30}}},{image:"static/asteroid-brown.png",textures:{rock:{x:0,y:0,width:64,height:64}}},{image:{src:"static/explosionSpriteSheet.png"},textures:{explosion:[{x:0,y:0,width:52,height:52},{x:52,y:0,width:52,height:52},{x:104,y:0,width:52,height:52},{x:156,y:0,width:52,height:52},{x:208,y:0,width:52,height:52},{x:0,y:52,width:52,height:52},{x:52,y:52,width:52,height:52},{x:104,y:52,width:52,height:52},{x:156,y:52,width:52,height:52},{x:208,y:52,width:52,height:52},{x:0,y:104,width:52,height:52},{x:52,y:104,width:52,height:52}]}},{image:{src:"static/crystalSpriteSheet.png"},textures:{crystal:function(t,e,n,i){for(var r=[],o=0,s=0,u=0;u<t;u++){0!=s&&r.push({x:o,y:s,width:n,height:i}),o=0;for(var a=0;a<e-1;a++)r.push({x:o,y:s,width:n,height:i}),o+=n;s+=i}return r}(36,5,50,90)}},{textures:{text:function(t){return t+="",r.a.canvas((function(e){this.size(16,24,2),e.scale(2,2),e.font="bold 24px monospace",e.fillStyle="#ddd",e.textBaseline="top",e.fillText(t,0,1)}))}}}];var s={dtCoefficient:.001,shuttleRotation:4,shuttleAcceleration:400,shuttleMaxVelocity:600,bulletVelocity:1e3,bulletDecay:1300,newRockChance:.4,newCrystalChance:.4,rockVelocityDist:{mu:75,sigma:20},rockSizeDist:{mu:2,sigma:.25},rockSpinSpeed:1,rockRicochet:200,initTimeLimit:1,backgroundColor:"#231f20",viewbox:{width:2436,height:1125},keyBindings:{32:"fire",38:"accelerate",37:"turnLeft",40:null,39:"turnRight",87:"accelerate",65:"turnLeft",83:null,68:"turnRight"},mouseBindings:{move:"focus",click:"accelerate",middleClick:null,rightClick:"fire"},actionIntervals:{fire:750,focus:100}};function u(t){return function(t){if(Array.isArray(t))return a(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return a(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return a(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function c(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function h(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var f=function(){function t(){c(this,t);for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];this.preArgs=n,this.callbacks=[]}var e,n,i;return e=t,(n=[{key:"on",value:function(t){return this.callbacks.push(t),this}},{key:"trigger",value:function(t){return this.on((function(){return t.emit.apply(t,arguments)}))}},{key:"emit",value:function(){for(var t=this,e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];this.callbacks.forEach((function(e){return e.apply(void 0,u(t.preArgs).concat(n))}))}}])&&h(e.prototype,n),i&&h(e,i),t}(),l=Math.PI,p=2*Math.PI;function y(t,e){return Math.sin(t)*e}function _(t,e){return-Math.cos(t)*e}function d(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=t-n,o=e-i;return Math.sqrt(r*r+o*o)}function v(t){for(;t>=p;)t-=p;for(;t<0;)t+=p;return t}function g(t,e,n,i){var r=n-t,o=i-e,s=Math.atan(-r/o);return o<0?s:s+l}function m(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function b(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var w=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1;m(this,t),this.node=e,this.offsetX=n,this.offsetY=i,this.rotation=r,this.scale=o,this.remove=new f}var e,n,i;return e=t,(n=[{key:"append",value:function(t){t.first().append(this.node)}},{key:"start",value:function(t){var e=this;this.append(t),this.node.pin({align:.5,offsetX:this.offsetX,offsetY:this.offsetY,rotation:this.rotation,scale:this.scale}),this.node.tick((function(n){return e.tick(n,t)})),this.remove.on((function(){return e.node.remove()}))}},{key:"tick",value:function(t,e){}},{key:"touching",value:function(t){var e=this.radius+t.radius;return!(!this.visible||!t.visible||Math.abs(this.offsetX-t.offsetX)>e||Math.abs(this.offsetY-t.offsetY)>e)&&d(this.offsetX,this.offsetY,t.offsetX,t.offsetY)<=e}},{key:"moveTo",value:function(t,e){this.offsetX=t,this.offsetY=e,this.node.pin({offsetX:t,offsetY:e})}},{key:"rotateTo",value:function(t){this.rotation=v(t),this.node.pin("rotation",t)}},{key:"scaleTo",value:function(t){this.scale=t,this.node.pin("scale",t)}},{key:"radius",get:function(){return this.node.width()*this.node.pin("scaleX")/2}},{key:"visible",get:function(){return null!=this.node.parent()}}])&&b(e.prototype,n),i&&b(e,i),t}();function x(t){if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(t=function(t,e){if(!t)return;if("string"==typeof t)return k(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return k(t,e)}(t))){var e=0,n=function(){};return{s:n,n:function(){return e>=t.length?{done:!0}:{done:!1,value:t[e++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,r,o=!0,s=!1;return{s:function(){i=t[Symbol.iterator]()},n:function(){var t=i.next();return o=t.done,t},e:function(t){s=!0,r=t},f:function(){try{o||null==i.return||i.return()}finally{if(s)throw r}}}}function k(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function S(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function O(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function j(t,e,n){return e&&O(t.prototype,e),n&&O(t,n),t}function R(){return performance.now()}var T=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:s.keyBindings,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:s.mouseBindings,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Input";S(this,t),this.keyBindings=e,this.mouseBindings=n,this.source=i,this.valueCache={},this.timeouts={},this.firstTouchId=null,this.secondTouchId=null}return j(t,[{key:"start",value:function(t){var e=this;document.onkeydown=function(n){return e.onKeyDown(t,n)},document.onkeyup=function(n){return e.onKeyUp(t,n)},document.onmouseout=function(n){return e.onMouseOut(t,n)},document.oncontextmenu=function(t){return!1},t.on("mousemove",(function(n){return e.onMouseMove(t,n)})),t.on("touchmove",(function(n){return e.onTouchMove(t,n)})),t.on("mousedown",(function(n){return e.onMouseStart(t,n)})),t.on("touchstart",(function(n){return e.onTouchStart(t,n)})),t.on(["mouseup","mousecancel"],(function(n){return e.onMouseEnd(t,n)})),t.on(["touchend","touchcancel"],(function(n){return e.onTouchEnd(t,n)}))}},{key:"setAction",value:function(t,e,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:R;if(e&&!n.equals(this.valueCache[e])){this.valueCache[e]=n;var r=s.actionIntervals[e];r?this.startInterval(t,e,r,i,n):t.publish("".concat(this.source,".action.").concat(e),[i(),n])}}},{key:"startInterval",value:function(t,e,n,i,r){this.timeouts[e]||(t.publish("".concat(this.source,".action.").concat(e),[i(),r]),this.delayNextPublish(t,e,n,i,r))}},{key:"delayNextPublish",value:function(t,e,n,i,r){var o=this;this.timeouts[e]=setTimeout((function(){o.timeouts[e]=void 0;var s=o.valueCache[e];s&&!s.equals(r)&&o.startInterval(t,e,n,i,s)}),n)}},{key:"clearAction",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:R;e&&this.valueCache[e]&&(this.valueCache[e]=void 0,t.publish("".concat(this.source,".action.").concat(e,".clear"),[n()]))}},{key:"onKeyDown",value:function(t,e){this.setAction(t,this.keyBindings[e.keyCode],new M)}},{key:"onKeyUp",value:function(t,e){this.clearAction(t,this.keyBindings[e.keyCode])}},{key:"onMouseMove",value:function(t,e){var n=e.x-t.width()/2,i=e.y-t.height()/2,r=new E(n,i);this.setAction(t,this.mouseBindings.move,r)}},{key:"onMouseOut",value:function(t,e){this.mouseMovePoint=null,this.clearAction(t,this.mouseBindings.move)}},{key:"onMouseStart",value:function(t,e){var n=e.raw.button;0===n?this.setAction(t,this.mouseBindings.click,new M):1===n?this.setAction(t,this.mouseBindings.middleClick,new M):2===n&&this.setAction(t,this.mouseBindings.rightClick,new M)}},{key:"onMouseEnd",value:function(t,e){var n=e.raw.button;0===n?this.clearAction(t,this.mouseBindings.click):1===n?this.clearAction(t,this.mouseBindings.middleClick):2===n&&this.clearAction(t,this.mouseBindings.rightClick)}},{key:"onTouchMove",value:function(t,e){this.isTouchChanged(e,this.firstTouchId)&&this.onMouseMove(t,e)}},{key:"onTouchStart",value:function(t,e){var n=e.raw.changedTouches,i=0;null===this.firstTouchId&&(this.firstTouchId=n[i++].identifier,this.onTouchMove(t,e)),null===this.secondTouchId&&n[i]&&(this.secondTouchId=n[i++].identifier,this.setAction(t,this.mouseBindings.click,new M))}},{key:"onTouchEnd",value:function(t,e){this.isTouchChanged(e,this.firstTouchId)&&(this.firstTouchId=null,this.clearAction(t,this.mouseBindings.move)),this.isTouchChanged(e,this.secondTouchId)&&(this.secondTouchId=null,this.clearAction(t,this.mouseBindings.click))}},{key:"isTouchChanged",value:function(t,e){if(e){var n,i=x(t.raw.changedTouches);try{for(i.s();!(n=i.n()).done;){if(n.value.identifier===e)return!0}}catch(t){i.e(t)}finally{i.f()}}return!1}}]),t}(),M=function(){function t(){S(this,t),this.active=!0}return j(t,[{key:"equals",value:function(e){return e instanceof t}}]),t}(),E=function(){function t(e,n){S(this,t),this.x=e,this.y=n}return j(t,[{key:"equals",value:function(t){return t&&this.x===t.x&&this.y===t.y}}]),t}();function P(t){if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(t=function(t,e){if(!t)return;if("string"==typeof t)return A(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return A(t,e)}(t))){var e=0,n=function(){};return{s:n,n:function(){return e>=t.length?{done:!0}:{done:!1,value:t[e++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,r,o=!0,s=!1;return{s:function(){i=t[Symbol.iterator]()},n:function(){var t=i.next();return o=t.done,t},e:function(t){s=!0,r=t},f:function(){try{o||null==i.return||i.return()}finally{if(s)throw r}}}}function A(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function X(t){return(X="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Y(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function C(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function B(t,e,n){return e&&C(t.prototype,e),n&&C(t,n),t}function D(t,e){return!e||"object"!==X(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function I(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function L(t){return(L=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function U(t,e){return(U=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var q=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&U(t,e)}(i,t);var e,n=(e=i,function(){var t,n=L(e);if(I()){var i=L(this).constructor;t=Reflect.construct(n,arguments,i)}else t=n.apply(this,arguments);return D(this,t)});function i(t,e){var r;return Y(this,i),(r=n.call(this)).leftSet=t,r.rightSet=e,r}return B(i,[{key:"triggerLeft",value:function(t){return this.on((function(e,n){return t(e).emit(n)}))}},{key:"triggerRight",value:function(t){return this.on((function(e,n){return t(n).emit(e)}))}}]),i}(f),F=function(){function t(){Y(this,t),this.groups=[]}return B(t,[{key:"detect",value:function(t,e){var n=new q(t,e);return this.groups.push(n),n}},{key:"start",value:function(t){var e=this;t.tick((function(n){return e.tick(n,t)}))}},{key:"tick",value:function(t,e){var n,i=P(this.groups);try{for(i.s();!(n=i.n()).done;){var r,o=n.value,s=P(o.leftSet);try{for(s.s();!(r=s.n()).done;){var u,a=r.value,c=P(o.rightSet);try{for(c.s();!(u=c.n()).done;){var h=u.value;a!==h&&a.touching(h)&&o.emit(a,h)}}catch(t){c.e(t)}finally{c.f()}}}catch(t){s.e(t)}finally{s.f()}}}catch(t){i.e(t)}finally{i.f()}}}]),t}();function G(t){if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(t=function(t,e){if(!t)return;if("string"==typeof t)return H(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return H(t,e)}(t))){var e=0,n=function(){};return{s:n,n:function(){return e>=t.length?{done:!0}:{done:!1,value:t[e++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,r,o=!0,s=!1;return{s:function(){i=t[Symbol.iterator]()},n:function(){var t=i.next();return o=t.done,t},e:function(t){s=!0,r=t},f:function(){try{o||null==i.return||i.return()}finally{if(s)throw r}}}}function H(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function W(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var z=function(){function t(e,n,i){var r=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.node=e,this.source=n,this.actions=i,this.times={},this.values={};var o,s=G(i);try{var u=function(){var t=o.value;r.hasOwnProperty(t)||Object.defineProperty(r,t,{get:function(){return r.get(t)}})};for(s.s();!(o=s.n()).done;)u()}catch(t){s.e(t)}finally{s.f()}}var e,n,i;return e=t,(n=[{key:"start",value:function(t){var e,n=this,i=G(this.actions);try{var r=function(){var i=e.value;t.on("".concat(n.source,".action.").concat(i),(function(t,e){n.node.publish("action.".concat(i),[t,e]),n.times[i]=t,n.values[i]=e})),t.on("".concat(n.source,".action.").concat(i,".clear"),(function(t){n.node.publish("action.".concat(i,".clear"),[t]),n.times[i]=t,n.values[i]=void 0}))};for(i.s();!(e=i.n()).done;)r()}catch(t){i.e(t)}finally{i.f()}}},{key:"get",value:function(t){return this.values[t]}},{key:"getTime",value:function(t){return this.times[t]}},{key:"on",value:function(t,e){this.node.on("action.".concat(t),e)}},{key:"onClear",value:function(t,e){this.node.on("action.".concat(t,".clear"),e)}}])&&W(e.prototype,n),i&&W(e,i),t}();function V(t){return(V="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function $(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function N(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function K(t,e,n){return(K="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var i=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Z(t)););return t}(t,e);if(i){var r=Object.getOwnPropertyDescriptor(i,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function J(t,e){return!e||"object"!==V(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Q(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function Z(t){return(Z=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function tt(t,e){return(tt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var et=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&tt(t,e)}(u,t);var e,n,i,r,o=(e=u,function(){var t,n=Z(e);if(Q()){var i=Z(this).constructor;t=Reflect.construct(n,arguments,i)}else t=n.apply(this,arguments);return J(this,t)});function u(t,e,n,i,r){var s,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,c=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,h=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0;return $(this,u),(s=o.call(this,t,e,n,i,r)).velocityX=a,s.velocityY=c,s.spin=h,s}return n=u,(i=[{key:"getRightEdge",value:function(t){return t.width()/2+2*this.radius}},{key:"getBottomEdge",value:function(t){return t.height()/2+2*this.radius}},{key:"moveBy",value:function(t,e,n){var i=n?n*s.dtCoefficient:1,r=t?t*i:0,o=e?e*i:0;0===r&&0===o||this.moveTo(this.offsetX+r,this.offsetY+o)}},{key:"rotateBy",value:function(t,e){var n=t?t*(e?e*s.dtCoefficient:1):0;0!==n&&this.rotateTo(this.rotation+n)}},{key:"accelerate",value:function(t,e,n,i){var r=i?i*s.dtCoefficient:1;if(this.velocityX+=y(t,e*r),this.velocityY+=_(t,e*r),n){var o=d(this.velocityX,this.velocityY);if(o>=n){var u=n/o;this.velocityX*=u,this.velocityY*=u}}}},{key:"ricochet",value:function(t,e,n,i){var r=Math.PI+g(this.offsetX,this.offsetY,t.offsetX,t.offsetY);this.accelerate(r,e,n,i)}},{key:"tick",value:function(t,e){K(Z(u.prototype),"tick",this).call(this,t,e),this.rotateBy(this.spin,t),this.moveBy(this.velocityX,this.velocityY,t);var n=this.getRightEdge(e),i=this.getBottomEdge(e);this.offsetX>=n?this.onLeave("right"):this.offsetX<=-n&&this.onLeave("left"),this.offsetY>=i?this.onLeave("bottom"):this.offsetY<=-i&&this.onLeave("top")}},{key:"onLeave",value:function(t){}}])&&N(n.prototype,i),r&&N(n,r),u}(w);function nt(t){return(nt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function it(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function rt(t,e,n){return(rt="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var i=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=ut(t)););return t}(t,e);if(i){var r=Object.getOwnPropertyDescriptor(i,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function ot(t,e){return!e||"object"!==nt(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function st(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function ut(t){return(ut=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function at(t,e){return(at=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ct=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&at(t,e)}(a,t);var e,n,i,o,u=(e=a,function(){var t,n=ut(e);if(st()){var i=ut(this).constructor;t=Reflect.construct(n,arguments,i)}else t=n.apply(this,arguments);return ot(this,t)});function a(t,e,n,i,o){var c;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a);var h=i+y(n,s.bulletVelocity),f=o+_(n,s.bulletVelocity),l=r.a.image("bullet");return(c=u.call(this,l,t,e,n,void 0,h,f)).expires=performance.now()+s.bulletDecay,c}return n=a,(i=[{key:"tick",value:function(t,e){rt(ut(a.prototype),"tick",this).call(this,t,e),performance.now()>=this.expires&&this.remove.emit()}},{key:"onLeave",value:function(t){"top"===t||"bottom"===t?this.moveTo(this.offsetX,-this.offsetY):"left"!==t&&"right"!==t||this.moveTo(-this.offsetX,this.offsetY)}}])&&it(n.prototype,i),o&&it(n,o),a}(et);function ht(t){return(ht="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ft(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function lt(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function pt(t,e,n){return e&&lt(t.prototype,e),n&&lt(t,n),t}function yt(t,e,n){return(yt="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var i=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=gt(t)););return t}(t,e);if(i){var r=Object.getOwnPropertyDescriptor(i,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function _t(t){return function(){var e,n=gt(t);if(vt()){var i=gt(this).constructor;e=Reflect.construct(n,arguments,i)}else e=n.apply(this,arguments);return dt(this,e)}}function dt(t,e){return!e||"object"!==ht(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function vt(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function gt(t){return(gt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function mt(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&bt(t,e)}function bt(t,e){return(bt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var wt=function(t){mt(n,t);var e=_t(n);function n(t){var i;return ft(this,n),(i=e.call(this,r.a.image("shuttle"))).bulletSet=new Set,i.reloading=!1,i.actions=new z(i.node,t,["fire","focus","turnLeft","turnRight","accelerate"]),i}return pt(n,[{key:"start",value:function(t){var e=this;yt(gt(n.prototype),"start",this).call(this,t),this.actions.start(t),this.actions.on("fire",(function(n){return e.fireBullet(t,n)})),this.actions.on("turnLeft",(function(){return e.turnLeft()})),this.actions.onClear("turnLeft",(function(){return e.turnRight()})),this.actions.on("turnRight",(function(){return e.turnRight()})),this.actions.onClear("turnRight",(function(){return e.turnLeft()})),this.remove.on((function(){return e.explode(t)}))}},{key:"tick",value:function(t,e){if(yt(gt(n.prototype),"tick",this).call(this,t,e),this.actions.focus&&0===this.spin){var i=this.getFocusAngle(this.actions.focus),r=(o=this.rotation,(u=v(i)-v(o))>l?u-p:u<-l?u+p:u);this.rotateBy(r*s.shuttleRotation,t)}var o,u;this.actions.accelerate&&this.accelerate(this.rotation,s.shuttleAcceleration,s.shuttleMaxVelocity,t)}},{key:"explode",value:function(t){new xt(this.offsetX,this.offsetY).start(t)}},{key:"turnLeft",value:function(){this.spin-=s.shuttleRotation}},{key:"turnRight",value:function(){this.spin+=s.shuttleRotation}},{key:"getFocusAngle",value:function(t){return g(this.offsetX,this.offsetY,t.x,t.y)}},{key:"fireBullet",value:function(t,e){var n=this,i=new ct(this.offsetX,this.offsetY,this.rotation,this.velocityX,this.velocityY);this.bulletSet.add(i),i.remove.on((function(){return n.bulletSet.delete(i)})),i.start(t)}},{key:"onLeave",value:function(t){"top"===t||"bottom"===t?this.moveTo(this.offsetX,-this.offsetY):"left"!==t&&"right"!==t||this.moveTo(-this.offsetX,this.offsetY)}}]),n}(et),xt=function(t){mt(n,t);var e=_t(n);function n(t,i){ft(this,n);var o=r.a.anim("explosion");return e.call(this,o,t,i)}return pt(n,[{key:"start",value:function(t){var e=this;yt(gt(n.prototype),"start",this).call(this,t),this.node.repeat(1,(function(){return e.remove.emit()}))}}]),n}(w);function kt(t,e){return Math.random()*(e-t)+t}function St(t){var e,n,i=t.mu,r=t.sigma;return e=Math.random(),n=Math.random(),Math.sqrt(-2*Math.log(e))*Math.cos(2*Math.PI*n)*r+i}function Ot(){return Math.random()>.5?1:-1}function jt(t){return(jt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Rt(t,e,n){return(Rt="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var i=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Et(t)););return t}(t,e);if(i){var r=Object.getOwnPropertyDescriptor(i,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function Tt(t,e){return!e||"object"!==jt(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Mt(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function Et(t){return(Et=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Pt(t,e){return(Pt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function At(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Xt(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Yt(t,e,n){return e&&Xt(t.prototype,e),n&&Xt(t,n),t}var Ct=function(){function t(){At(this,t),this.numRocksStart=10,this.rocksPct=.6,this.rockSet=new Set}return Yt(t,[{key:"start",value:function(t){var e=this;setInterval((function(){return e.maybeMakeRocks(t)}),500)}},{key:"maybeMakeRocks",value:function(t){var e=this;if(Math.random()<s.newRockChance){var n=this.makeRock(t);this.rockSet.add(n),n.remove.on((function(){return e.rockSet.delete(n)})),n.start(t)}}},{key:"makeRock",value:function(t){var e=Ot()*St(s.rockVelocityDist),n=Ot()*St(s.rockVelocityDist),i=St(s.rockSizeDist);if(Math.random()<.5){var r=.55*t.width(),o=kt(-t.height()/2,t.height()/2);return e>0&&(r=-r),new Bt(r,o,i,e,n)}var u=kt(-t.width()/2,t.width()/2),a=.55*t.height();return n>0&&(a=-a),new Bt(u,a,i,e,n)}}]),t}(),Bt=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Pt(t,e)}(i,t);var e,n=(e=i,function(){var t,n=Et(e);if(Mt()){var i=Et(this).constructor;t=Reflect.construct(n,arguments,i)}else t=n.apply(this,arguments);return Tt(this,t)});function i(t,e,o,u,a){var c;At(this,i);var h=kt(0,2*Math.PI),l=kt(-s.rockSpinSpeed,s.rockSpinSpeed),p=r.a.image("rock");return(c=n.call(this,p,t,e,h,o,u,a,l)).shoot=new f,c}return Yt(i,[{key:"start",value:function(t){var e=this;Rt(Et(i.prototype),"start",this).call(this,t),this.shoot.on((function(t){return e.ricochet(t,s.rockRicochet,0)}))}},{key:"onLeave",value:function(){this.remove.emit()}}]),i}(et);function Dt(t){return(Dt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function It(t,e,n){return(It="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var i=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=qt(t)););return t}(t,e);if(i){var r=Object.getOwnPropertyDescriptor(i,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function Lt(t,e){return!e||"object"!==Dt(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Ut(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function qt(t){return(qt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ft(t,e){return(Ft=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Gt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Ht(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Wt(t,e,n){return e&&Ht(t.prototype,e),n&&Ht(t,n),t}var zt=function(){function t(){Gt(this,t),this.crystalSet=new Set}return Wt(t,[{key:"start",value:function(t){var e=this;setInterval((function(){return e.maybeMakeCrystals(t)}),2e3)}},{key:"maybeMakeCrystals",value:function(t){var e=this;if(Math.random()<s.newCrystalChance){var n=this.makeCrystal(t);this.crystalSet.add(n),n.remove.on((function(){return e.crystalSet.delete(n)})),n.start(t)}}},{key:"makeCrystal",value:function(t){var e=kt(-t.width()/2,t.width()/2),n=kt(-t.height()/2,t.height()/2);return new Vt(e,n)}}]),t}(),Vt=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ft(t,e)}(i,t);var e,n=(e=i,function(){var t,n=qt(e);if(Ut()){var i=qt(this).constructor;t=Reflect.construct(n,arguments,i)}else t=n.apply(this,arguments);return Lt(this,t)});function i(t,e){Gt(this,i);var o=r.a.anim("crystal");return n.call(this,o,t,e)}return Wt(i,[{key:"start",value:function(t){var e=this;It(qt(i.prototype),"start",this).call(this,t),this.node.repeat(10,(function(){return e.remove.emit()})).fps(60)}}]),i}(et);function $t(t){return($t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Nt(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var n=[],i=!0,r=!1,o=void 0;try{for(var s,u=t[Symbol.iterator]();!(i=(s=u.next()).done)&&(n.push(s.value),!e||n.length!==e);i=!0);}catch(t){r=!0,o=t}finally{try{i||null==u.return||u.return()}finally{if(r)throw o}}return n}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return Kt(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Kt(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Kt(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function Jt(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Qt(t,e,n){return(Qt="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var i=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=ee(t)););return t}(t,e);if(i){var r=Object.getOwnPropertyDescriptor(i,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function Zt(t,e){return!e||"object"!==$t(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function te(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function ee(t){return(ee=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ne(t,e){return(ne=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ie=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ne(t,e)}(u,t);var e,n,i,o,s=(e=u,function(){var t,n=ee(e);if(te()){var i=ee(this).constructor;t=Reflect.construct(n,arguments,i)}else t=n.apply(this,arguments);return Zt(this,t)});function u(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u),(e=s.call(this,r.a.string("text"))).timeLimit=t,e.expire=new f,e.addTime=new f,e}return n=u,(i=[{key:"append",value:function(t){t.append(this.node)}},{key:"start",value:function(t){var e=this;Qt(ee(u.prototype),"start",this).call(this,t),this.node.pin({alignY:.95}),this.setCountDownTimer(60*this.timeLimit),this.startCountDownTimer(t),this.addTime.on((function(){return e.extendTimer()}))}},{key:"startCountDownTimer",value:function(t){var e;this.intervalID=setInterval((e=this,function(){e.updateCountDownTimer(t)}),1e3)}},{key:"updateCountDownTimer",value:function(t){var e=this.getCurrentTime();e>0&&(e-1==0&&(this.expire.emit(),clearInterval(this.intervalID)),this.setCountDownTimer(e-1))}},{key:"getCurrentTime",value:function(){var t=Nt(this.node.value().split(":"),2),e=t[0],n=t[1];return e=parseInt(e),n=parseInt(n),n+=60*e}},{key:"setCountDownTimer",value:function(t){var e=Math.floor(t/60),n="".concat(t%60).padStart(2,"0");this.node.value("".concat(e,":").concat(n))}},{key:"extendTimer",value:function(){var t=this.getCurrentTime();this.setCountDownTimer(t+5)}}])&&Jt(n.prototype,i),o&&Jt(n,o),u}(w);function re(t){return(re="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function oe(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function se(t,e,n){return(se="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var i=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=ce(t)););return t}(t,e);if(i){var r=Object.getOwnPropertyDescriptor(i,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function ue(t,e){return!e||"object"!==re(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ae(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function ce(t){return(ce=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function he(t,e){return(he=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var fe=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&he(t,e)}(a,t);var e,n,i,o,u=(e=a,function(){var t,n=ce(e);if(ae()){var i=ce(this).constructor;t=Reflect.construct(n,arguments,i)}else t=n.apply(this,arguments);return ue(this,t)});function a(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),u.call(this,r.a.create())}return n=a,(i=[{key:"append",value:function(t){t.prepend(this.node)}},{key:"start",value:function(t){var e=this;se(ce(a.prototype),"start",this).call(this,t);var n=new T,i=new F,r=new Ct,o=new zt,u=new ie(s.initTimeLimit),c=new wt(n.source),h=new f;n.start(t),r.start(t),o.start(t),u.start(t),i.start(t),c.start(t),h.trigger(c.remove).trigger(u.remove),u.expire.trigger(h),i.detect([c],r.rockSet).trigger(h),i.detect(r.rockSet,c.bulletSet).triggerLeft((function(t){return t.shoot})).triggerRight((function(t){return t.remove})),i.detect([c],o.crystalSet).trigger(u.addTime).triggerRight((function(t){return t.remove})),this.node.size(s.viewbox.width,s.viewbox.height),this.node.pin({align:.5}),t.background(s.backgroundColor),t.on("viewport",(function(n){return e.scaleScreen(t,n)}))}},{key:"scaleScreen",value:function(t,e){var n=this.node,i=n.width()/n.height(),r=e.width/e.height;t.size(e.width,e.height),i>r?n.pin({scaleWidth:e.width,scaleHeight:e.width/i}):n.pin({scaleWidth:e.height*i,scaleHeight:e.height})}}])&&oe(n.prototype,i),o&&oe(n,o),a}(w);o.forEach((function(t){return r()(t)})),r()((function(t){return(new fe).start(t)}))}]);